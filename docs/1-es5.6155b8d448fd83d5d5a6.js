!function(){function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(a){i=!0,o=a}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"I/3d":function(r,i,s){"use strict";s.d(i,"a",function(){return Qp});var a=s("fXoL"),c=s("D0XW"),h=s("HDdC"),f=s("Cfvw"),l=s("LRne"),p=s("lJxs"),d=s("Kqap"),v=s("pLZG"),y=s("pxpQ"),g=s("spgP"),b=s("ofXK"),m=s("So3f"),w=s("zIRd"),_=s("q/0M"),I=s("qOnz"),E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function O(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},N=j||self;function k(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),C=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function R(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:R).apply(null,arguments)}function L(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function V(){return Date.now()}function M(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,D)&&t[D]||(t[D]=++C)}(this)},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:t>e?1:0}t:{var Y=N.navigator;if(Y){var J=Y.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=k;var rt,it,ot=X(W,"Opera"),st=X(W,"Trident")||X(W,"MSIE"),ut=X(W,"Edge"),at=ut||st,ct=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ht=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ft(){var t=N.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=W,ct?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ht?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var vt={};function yt(t){return function(t,e){var n=vt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=H(String(rt)).split("."),r=H(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Q(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Q(0==s[2].length,0==u[2].length)||Q(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var gt=N.document&&st&&(ft()||parseInt(rt,10))||void 0,bt=!st||9<=Number(gt),mt=st&&!yt("9"),wt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",k,e),N.removeEventListener("test",k,e)}catch(n){}return t}();function _t(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(_t.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{nt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}_t.prototype.b=function(){this.defaultPrevented=!0},M(It,_t);var Et={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Ot="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function jt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=F(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(At(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new jt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function Ct(t,e,n,r,i){if(r&&r.once)return Rt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Ot]?t.va(e,n,S(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=S(i)?!!i.capture:!!i;if(s&&!bt)return null;var u=Ft(t);if(u||(t[St]=u=new Nt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=qt,e=bt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Ot]?t.wa(e,n,S(r)?!!r.capture:!!r,i):Pt(t,e,n,!0,r,i)}function Ut(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Ut(t,e[o],n,r,i);else r=S(r)?!!r.capture:!!r,n=Bt(n),t&&t[Ot]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=xt(o=t.a[e],n,r,i))&&(At(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Ft(t))&&(e=t.a[e.toString()],t=-1,e&&(t=xt(e,n,r,i)),(n=-1<t?e[t]:null)&&Lt(n))}function Lt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Ot])kt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(kt(n,t),0==n.b&&(n.src=null,e[St]=null)):At(t)}}}function Vt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function qt(t,e){if(t.Y)return!0;if(!bt){if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new It(e,this))}return Mt(t,new It(e,this))}function Ft(t){return(t=t[St])instanceof Nt?t:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(t){return"function"==typeof t?t:(t[zt]||(t[zt]=function(e){return t.handleEvent(e)}),t[zt])}function Gt(){q.call(this),this.c=new Nt(this),this.J=this,this.C=null}function Kt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new _t(e,t);else if(e instanceof _t)e.target=e.target||t;else{var i=e;et(e=new _t(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Wt(s,r,!0,e)&&i}if(i=Wt(s=e.a=t,r,!0,e)&&i,i=Wt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Wt(s=e.a=n[o],r,!1,e)&&i}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&kt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}M(Gt,q),Gt.prototype[Ot]=!0,(T=Gt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){Ut(this,t,e,n,r)},T.G=function(){if(Gt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},T.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=N.JSON.stringify;function Xt(){this.b=this.a=null}var Qt,Yt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new $t},function(t){t.reset()});function Jt(){var t=ne,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function $t(){this.next=this.b=this.a=null}function Zt(t){N.setTimeout(function(){throw t},0)}function te(t,e){Qt||function(){var t=N.Promise.resolve(void 0);Qt=function(){t.then(re)}}(),ee||(Qt(),ee=!0),ne.add(t,e)}Xt.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},$t.prototype.reset=function(){this.next=this.b=this.a=null};var ee=!1,ne=new Xt;function re(){for(var t;t=Jt();){try{t.a.call(t.b)}catch(n){Zt(n)}var e=Yt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ee=!1}function ie(t,e){Gt.call(this),this.b=t||1,this.a=e||N,this.f=U(this.Za,this),this.g=V()}function oe(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function se(t,e,n){if("function"==typeof t)n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}function ue(t){t.a=se(function(){t.a=null,t.c&&(t.c=!1,ue(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}M(ie,Gt),(T=ie.prototype).aa=!1,T.M=null,T.Za=function(){if(this.aa){var t=V()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Kt(this,"tick"),this.aa&&(oe(this),this.start()))}},T.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},T.G=function(){ie.X.G.call(this),oe(this),delete this.a};var ae=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:ue(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(q);function ce(t){q.call(this),this.b=t,this.a={}}M(ce,q);var he=[];function fe(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ht(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.X.G.call(this),le(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ve={},ye=null;function ge(){return ye=ye||new Gt}function be(t){_t.call(this,ve.Fa,t)}function me(t){var e=ge();Kt(e,new be(e,t))}function we(t,e){_t.call(this,ve.STAT_EVENT,t),this.stat=e}function _e(t){var e=ge();Kt(e,new we(e,t))}function Ie(t){_t.call(this,ve.Ga,t)}function Ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}ve.Fa="serverreachability",M(be,_t),ve.STAT_EVENT="statevent",M(we,_t),ve.Ga="timingevent",M(Ie,_t);var Oe={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function je(){}function Ae(){}je.prototype.a=null;var Ne,ke={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function xe(){_t.call(this,"d")}function Se(){_t.call(this,"c")}function De(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ce(this),this.P=Pe,this.R=new ie(t=at?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(xe,_t),M(Se,_t),M(De,je),Ne=new De;var Pe=45e3,Re={},Ue={};function Le(t,e,n){t.H=1,t.i=sn(Ze(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=V(),Fe(t),t.l=Ze(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(U(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Xa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Me(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=qe(t,n);if(i==Ue){4==e&&(t.h=4,_e(14),r=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(i==Re){t.h=4,_e(15),de(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}de(t.c,t.f,i,null),We(t,i)}4==e&&0==n.length&&(t.h=1,_e(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0,_e(11))):(de(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),Ge(t))}function qe(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ue:(n=Number(e.substring(n,r)),isNaN(n)?Re:(r+=1)+n>e.length?Ue:(e=e.substr(r,n),t.D=r+n,e))}function Fe(t){t.T=V()+t.P,ze(t,t.P)}function ze(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(U(t.Va,t),e)}function Be(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||ar(t.g,t)}function Ke(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,oe(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function We(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||jn(n.b,t)))if(n.I=t.N,!t.C&&jn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(rp){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;ur(n),Yn(n)}ir(n),_e(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Ee(U(n.Sa,n),6e3));if(1>=Tn(n.b)&&n.ea){try{n.ea()}catch(rp){}n.ea=void 0}}else hr(n,11)}else if((t.C||n.a==t)&&ur(n),!K(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(X(h,"spdy")||X(h,"quic")||X(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(An(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,on(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=V()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=lr(a,a.C?a.ga:null,a.fa),p.C){Nn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Be(d),Fe(d)),a.a=p}else rr(a);0<n.g.length&&Zn(n)}else"stop"!=i[0]&&"close"!=i[0]||hr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?hr(n,7):Qn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);me(4)}catch(rp){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Ce.prototype).setTimeout=function(t){this.P=t},T.Xa=function(t){t=t.target;var e=this.F;e&&3==Kn(t)?e.f():this.Ca(t)},T.Ca=function(t){try{if(t==this.a)t:{var e=Kn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(8==n||0>=r?3:2),Be(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,_e(12),Ke(this),Ge(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,We(this,a)}this.I?(Me(this,e,o),at&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Wa),this.R.start())):(de(this.c,this.f,o,null),We(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?ar(this.g,this):(this.b=!1,Fe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,_e(12)):(this.h=0,_e(13)),Ke(this),Ge(this)}}}catch(c){}},T.Wa=function(){if(this.a){var t=Kn(this.a),e=this.a.$();this.D<e.length&&(Be(this),Me(this,t,e),this.b&&4!=t&&Fe(this))}},T.cancel=function(){this.A=!0,Ke(this)},T.Va=function(){this.o=null;var t=V();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(me(3),_e(17)),Ke(this),this.h=2,Ge(this)):ze(this,this.T-t)},(T=Xe.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.L=function(){return Qe(this),this.a.concat()},T.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},T.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e){this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b;var n=new vn;n.c=e.c,e.a&&(n.a=new Xe(e.a),n.b=e.b),rn(this,n),this.i=t.i}else t&&(n=String(t).match(Je))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=un(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=un(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new vn(null,this.a))}function Ze(t){return new $e(t)}function tn(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?un(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){e instanceof vn?(t.b=e,function(t,e){e&&!t.f&&(yn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),mn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=an(e,pn)),t.b=new vn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,hn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(an(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,dn)),t.join("")};var hn=/[#\/\?@]/g,fn=/[#\?:]/g,ln=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(t){t.a||(t.a=new Xe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function gn(t,e){yn(t),e=wn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function bn(t,e){return yn(t),e=wn(t,e),Ye(t.a.b,e)}function mn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),G(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(T=vn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(t,e){yn(this),this.a.forEach(function(n,r){z(n,function(n){t.call(e,n,r,this)},this)},this)},T.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.K=function(t){yn(this);var e=[];if("string"==typeof t)bn(this,t)&&(e=B(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return yn(this),this.c=null,bn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var _n=function(t,e){this.b=t,this.a=e};function In(t){this.g=t||En,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var En=10;function On(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function jn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function kn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=O(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return G(t.c)}function xn(){}function Sn(){this.a=new xn}function Dn(t,e,n){var r=n||"";try{He(t,function(t,n){var i=t;S(t)&&(i=Ht(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Cn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}In.prototype.cancel=function(){var t,e;if(this.c=kn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=O(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},xn.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var Pn=N.JSON.parse;function Rn(t){Gt.call(this),this.headers=new Xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}M(Rn,Gt);var Un="",Ln=/^https?$/i,Vn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),Bn(t)}function Fn(t){t.u||(t.u=!0,Kt(t,"complete"),Kt(t,"error"))}function zn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Kn(t)||2!=t.W()))if(t.l&&4==Kn(t))se(t.za,0,t);else if(Kt(t,"readystatechange"),4==Kn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Je)[1]||null;if(!o&&N.self&&N.self.location){var s=N.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ln.test(o?o.toLowerCase():"")}e=i}if(e)Kt(t,"complete"),Kt(t,"success");else{t.h=6;try{var u=2<Kn(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",Fn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||Kt(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Kn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return $(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Hn("baseRetryDelayMs",5e3,t),this.Ra=Hn("retryDelaySeedMs",1e4,t),this.Ma=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Qn(t){if(Jn(t),3==t.v){var e=t.R++,n=Ze(t.B);on(n,"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),er(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=sn(Ze(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=V(),Fe(e)}fr(t)}function Yn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function Jn(t){Yn(t),t.j&&(N.clearTimeout(t.j),t.j=null),ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new _n(t.Oa++,e)),3==t.v&&Zn(t)}function Zn(t){On(t.b)||t.h||(t.h=!0,te(t.Ba,t),t.u=0)}function tr(t,e){var n;n=e?e.f:t.R++;var r=Ze(t.B);on(r,"SID",t.J),on(r,"RID",n),on(r,"AID",t.P),er(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Le(n,r,e)}function er(t,e){t.f&&He({},function(t,n){on(e,n,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{Dn(h,s,"req"+c+"_")}catch(Wr){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.T=1,te(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Ee(U(t.Aa,t),cr(t,t.o)),t.o++,0))}function or(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Ce(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),er(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn(Ze(e)),n.j=null,n.I=!0,Ve(n,t)}function ur(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function ar(t,e){var n=null;if(t.a==e){ur(t),or(t),t.a=null;var r=2}else{if(!jn(t.b,e))return;n=e.s,Nn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=V()-e.u;var i=t.u;Kt(r=ge(),new Ie(r,n,e,i)),Zn(t)}else rr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Tn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Ee(U(t.Ba,t,e),cr(t,t.u)),t.u++,0)))}(t,e)||2==r&&ir(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function cr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function hr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=U(t.Ya,t);n||(n=new $e("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||tn(n,"https"),sn(n)),function(t,e){var n=new pe;if(N.Image){var r=new Image;r.onload=L(Cn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=L(Cn,n,r,"TestLoadImage: error",!1,e),r.onabort=L(Cn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=L(Cn,n,r,"TestLoadImage: timeout",!1,e),N.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else _e(2);t.v=0,t.f&&t.f.ra(e),fr(t),Jn(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==kn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function lr(t,e,n){var r=function(t){return t instanceof $e?Ze(t):new $e(t,void 0)}(n);if(""!=r.c)e&&en(r,e+"."+r.c),nn(r,r.h);else{var i=N.location;r=function(t,e,n,r){var i=new $e(null,void 0);return t&&tn(i,t),e&&en(i,e),n&&nn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&$(t.V,function(t,e){on(r,e,t)}),n=t.na,(e=t.A)&&n&&on(r,e,n),on(r,"VER",t.ha),er(t,r),r}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Na)).F=t.C,e}function dr(){}function vr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Gt.call(this),this.a=new Xn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new mr(this)}function gr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function br(){Se.call(this),this.status=1}function mr(t){this.a=t}(T=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:Ne),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void qn(this,o)}t=n||"";var i=new Xe(this.headers);r&&He(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=N.FormData&&t instanceof N.FormData,!(0<=F(Vn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=function(t){return st&&yt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=se(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){qn(this,o)}},T.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Kt(this,"timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Kt(this,"complete"),Kt(this,"abort"),Bn(this))},T.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Rn.X.G.call(this)},T.za=function(){this.j||(this.A||this.l||this.g?zn(this):this.Ua())},T.Ua=function(){zn(this)},T.W=function(){try{return 2<Kn(this)?this.a.status:-1}catch(it){return-1}},T.$=function(){try{return this.a?this.a.responseText:""}catch(it){return""}},T.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},T.ua=function(){return this.h},T.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Xn.prototype).ha=8,T.v=1,T.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),on(i=Ze(this.B),"RID",t),on(i,"CVER",22),this.A&&on(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Wn(i,this.i,r),An(this.b,n),this.Ia&&on(i,"TYPE","init"),this.da?(on(i,"$req",e),on(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||On(this.b)||tr(this))},T.Aa=function(){if(this.j=null,sr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ee(U(this.Ta,this),t)}},T.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,_e(10),Yn(this),sr(this))},T.Sa=function(){null!=this.m&&(this.m=null,Yn(this),ir(this),_e(19))},T.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),_e(2)):(this.c.info("Failed to ping google.com"),_e(1))},(T=dr.prototype).ta=function(){},T.sa=function(){},T.ra=function(){},T.qa=function(){},T.Ja=function(){},vr.prototype.a=function(t,e){return new yr(t,e)},M(yr,Gt),yr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;_e(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=lr(t,null,t.fa),Zn(t)},yr.prototype.close=function(){Qn(this.a)},yr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,$n(this.a,e)}else this.l?((e={}).__data__=Ht(t),$n(this.a,e)):$n(this.a,t)},yr.prototype.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,yr.X.G.call(this)},M(gr,xe),M(br,Se),M(mr,dr),mr.prototype.ta=function(){Kt(this.a,"a")},mr.prototype.sa=function(t){Kt(this.a,new gr(t))},mr.prototype.ra=function(t){Kt(this.a,new br(t))},mr.prototype.qa=function(){Kt(this.a,"b")},vr.prototype.createWebChannel=vr.prototype.a,yr.prototype.send=yr.prototype.h,yr.prototype.open=yr.prototype.g,yr.prototype.close=yr.prototype.close,Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,Te.COMPLETE="complete",Ae.EventType=ke,ke.OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.W,Rn.prototype.getResponseJson=Rn.prototype.Pa,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var wr=Oe,_r=Te,Ir=ve,Er=Ae,Or=Rn,Tr=s("/6Yf"),jr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ar=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Nr=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Nr.UNAUTHENTICATED=new Nr(null),Nr.l=new Nr("google-credentials-uid"),Nr._=new Nr("first-party-uid");var kr=new _.b("@firebase/firestore");function xr(){return kr.logLevel}function Sr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kr.logLevel<=_.a.DEBUG){var r=e.map(Pr);kr.debug.apply(kr,Object(m.j)(["Firestore (8.1.1): "+t],r))}}function Dr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kr.logLevel<=_.a.ERROR){var r=e.map(Pr);kr.error.apply(kr,Object(m.j)(["Firestore (8.1.1): "+t],r))}}function Cr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kr.logLevel<=_.a.WARN){var r=e.map(Pr);kr.warn.apply(kr,Object(m.j)(["Firestore (8.1.1): "+t],r))}}function Pr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function Rr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw Dr(e),new Error(e)}function Ur(t,e){t||Rr()}function Lr(t,e){return t}var Vr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(m.d)(e,t),e}(Error),qr=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},Fr=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(Nr.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),zr=function(){function t(t){var e=this;this.P=null,this.currentUser=Nr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.V!==e?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Ur("string"==typeof n.accessToken),new qr(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return Ur(null===t||"string"==typeof t),new Nr(t)},t}(),Br=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Nr._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Gr=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new Br(this.v,this.S))},t.prototype.A=function(t){t(Nr._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();function Kr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Wr=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Kr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Hr(t,e){return t<e?-1:t>e?1:0}function Xr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Qr(t){return t+"\0"}var Yr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?Hr(this.nanoseconds,t.nanoseconds):Hr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Jr=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new Yr(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),$r=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return this.L(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Zr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.H().join("/")},e.prototype.toString=function(){return this.J()},e.Y=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.X=function(){return new e([])},e}($r),ti=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.Z=function(t){return ti.test(t)},e.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.Z(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},e.et=function(){return new e(["__name__"])},e.nt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Mr(Vr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Mr(Vr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Mr(Vr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.X=function(){return new e([])},e}($r),ni=function(){function t(t){this.path=t}return t.st=function(e){return new t(Zr.Y(e))},t.it=function(e){return new t(Zr.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Zr.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return Zr.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new Zr(e.slice()))},t}();function ri(t){return null==t}function ii(t){return 0===t&&1/t==-1/0}function oi(t){return"number"==typeof t&&Number.isInteger(t)&&!ii(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var si=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function ui(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new si(t,e,n,r,i,o,s)}function ai(t){var e=Lr(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.J()+t.op.toString()+ro(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.J()+t.dir}(t)}).join(","),ri(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=su(e.startAt)),e.endAt&&(n+="|ub:",n+=su(e.endAt)),e.ut=n}return e.ut}function ci(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!fu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Zi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!au(t.startAt,e.startAt)&&au(t.endAt,e.endAt)}function hi(t){return ni.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var fi=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.at)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return Hr(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();fi.lt=new fi("");var li,pi,di=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=fi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),vi=function(t){this.count=t};function yi(t){switch(t){case Vr.OK:return Rr();case Vr.CANCELLED:case Vr.UNKNOWN:case Vr.DEADLINE_EXCEEDED:case Vr.RESOURCE_EXHAUSTED:case Vr.INTERNAL:case Vr.UNAVAILABLE:case Vr.UNAUTHENTICATED:return!1;case Vr.INVALID_ARGUMENT:case Vr.NOT_FOUND:case Vr.ALREADY_EXISTS:case Vr.PERMISSION_DENIED:case Vr.FAILED_PRECONDITION:case Vr.ABORTED:case Vr.OUT_OF_RANGE:case Vr.UNIMPLEMENTED:case Vr.DATA_LOSS:return!0;default:return Rr()}}function gi(t){if(void 0===t)return Dr("GRPC error has no .code"),Vr.UNKNOWN;switch(t){case li.OK:return Vr.OK;case li.CANCELLED:return Vr.CANCELLED;case li.UNKNOWN:return Vr.UNKNOWN;case li.DEADLINE_EXCEEDED:return Vr.DEADLINE_EXCEEDED;case li.RESOURCE_EXHAUSTED:return Vr.RESOURCE_EXHAUSTED;case li.INTERNAL:return Vr.INTERNAL;case li.UNAVAILABLE:return Vr.UNAVAILABLE;case li.UNAUTHENTICATED:return Vr.UNAUTHENTICATED;case li.INVALID_ARGUMENT:return Vr.INVALID_ARGUMENT;case li.NOT_FOUND:return Vr.NOT_FOUND;case li.ALREADY_EXISTS:return Vr.ALREADY_EXISTS;case li.PERMISSION_DENIED:return Vr.PERMISSION_DENIED;case li.FAILED_PRECONDITION:return Vr.FAILED_PRECONDITION;case li.ABORTED:return Vr.ABORTED;case li.OUT_OF_RANGE:return Vr.OUT_OF_RANGE;case li.UNIMPLEMENTED:return Vr.UNIMPLEMENTED;case li.DATA_LOSS:return Vr.DATA_LOSS;default:return Rr()}}(pi=li||(li={}))[pi.OK=0]="OK",pi[pi.CANCELLED=1]="CANCELLED",pi[pi.UNKNOWN=2]="UNKNOWN",pi[pi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pi[pi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pi[pi.NOT_FOUND=5]="NOT_FOUND",pi[pi.ALREADY_EXISTS=6]="ALREADY_EXISTS",pi[pi.PERMISSION_DENIED=7]="PERMISSION_DENIED",pi[pi.UNAUTHENTICATED=16]="UNAUTHENTICATED",pi[pi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pi[pi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pi[pi.ABORTED=10]="ABORTED",pi[pi.OUT_OF_RANGE=11]="OUT_OF_RANGE",pi[pi.UNIMPLEMENTED=12]="UNIMPLEMENTED",pi[pi.INTERNAL=13]="INTERNAL",pi[pi.UNAVAILABLE=14]="UNAVAILABLE",pi[pi.DATA_LOSS=15]="DATA_LOSS";var bi=function(){function t(t,e){this.$=t,this.root=e||wi.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,wi.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,wi.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Pt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new mi(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new mi(this.root,t,this.$,!1)},t.prototype.vt=function(){return new mi(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new mi(this.root,t,this.$,!0)},t}(),mi=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),wi=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Rr();if(this.right.Mt())throw Rr();var t=this.left.Qt();if(t!==this.right.Qt())throw Rr();return t+(this.Mt()?0:1)},t}();wi.EMPTY=null,wi.RED=!0,wi.It=!1,wi.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new wi(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());var _i=function(){function t(t){this.$=t,this.data=new bi(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt(function(e,n){return t(e),!1})},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new Ii(this.data.yt())},t.prototype.Vt=function(t){return new Ii(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),Ii=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),Ei=new bi(ni.$);function Oi(){return Ei}function Ti(){return Oi()}var ji=new bi(ni.$);function Ai(){return ji}var Ni=new bi(ni.$),ki=new _i(ni.$);function xi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ki,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Si=new _i(Hr);function Di(){return Si}var Ci=function(){function t(t){this.$=t?function(e,n){return t(e,n)||ni.$(e.key,n.key)}:function(t,e){return ni.$(t.key,e.key)},this.Ht=Ai(),this.Jt=new bi(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),Pi=function(){function t(){this.Xt=new bi(ni.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Rr():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt(function(e,n){t.push(n)}),t},t}(),Ri=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}return t.ie=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Ci.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Ks(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ui=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,Li.he(e,n)),new t(Jr.min(),r,Di(),Oi(),xi())},t}(),Li=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(fi.lt,n,xi(),xi(),xi())},t}(),Vi=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},Mi=function(t,e){this.targetId=t,this.Te=e},qi=function(t,e,n,r){void 0===n&&(n=fi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Fi=function(){function t(){this.Ie=0,this.me=Gi(),this.Ae=fi.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=xi(),e=xi(),n=xi();return this.me.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Rr()}}),new Li(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=Gi()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),zi=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=Oi(),this.Me=Bi(),this.ke=new _i(Hr)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof Ss?this.Le(r,t.Ee):t.Ee instanceof Ds&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Be(o[i],t.key,t.Ee)},t.prototype.qe=function(t){var e=this;this.Ue(t,function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:Rr()}})},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach(function(t,r){n.Ke(r)&&e(r)})},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(hi(i))if(0===n){var o=new ni(i.path);this.Be(e,o,new Ds(o,Jr.min()))}else Ur(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach(function(r,i){var o=e.Ge(i);if(o){if(r.le&&hi(o.target)){var s=new ni(o.target.path);null!==e.Oe.get(s)||e.Je(i,s)||e.Be(i,s,new Ds(s,t))}r.ye&&(n.set(i,r.pe()),r.ve())}});var r=xi();this.Me.forEach(function(t,n){var i=!0;n.Wt(function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Ui(t,n,this.ke,this.Oe,r);return this.Oe=Oi(),this.Me=Bi(),this.ke=new _i(Hr),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Fi,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new _i(Hr),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new Fi),this.xe.Xe(t).forEach(function(n){e.Be(t,n,null)})},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();function Bi(){return new bi(ni.$)}function Gi(){return new bi(ni.$)}function Ki(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Wi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Hi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Qi(t){var e=t.mapValue.fields.__previous_value__;return Xi(e)?Qi(e):e}function Yi(t){var e=oo(t.mapValue.fields.__local_write_time__.timestampValue);return new Yr(e.seconds,e.nanos)}var Ji=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $i(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xi(t)?4:10:Rr()}function Zi(t,e){var n=$i(t);if(n!==$i(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yi(t).isEqual(Yi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=oo(t.timestampValue),r=oo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return uo(t.bytesValue).isEqual(uo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return so(t.geoPointValue.latitude)===so(e.geoPointValue.latitude)&&so(t.geoPointValue.longitude)===so(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return so(t.integerValue)===so(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=so(t.doubleValue),r=so(e.doubleValue);return n===r?ii(n)===ii(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Xr(t.arrayValue.values||[],e.arrayValue.values||[],Zi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ki(n)!==Ki(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Zi(n[i],r[i])))return!1;return!0}(t,e);default:return Rr()}}function to(t,e){return void 0!==(t.values||[]).find(function(t){return Zi(t,e)})}function eo(t,e){var n=$i(t),r=$i(e);if(n!==r)return Hr(n,r);switch(n){case 0:return 0;case 1:return Hr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=so(t.integerValue||t.doubleValue),r=so(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return no(t.timestampValue,e.timestampValue);case 4:return no(Yi(t),Yi(e));case 5:return Hr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=uo(t),r=uo(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Hr(n[i],r[i]);if(0!==o)return o}return Hr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Hr(so(t.latitude),so(e.latitude));return 0!==n?n:Hr(so(t.longitude),so(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=eo(n[i],r[i]);if(o)return o}return Hr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Hr(r[s],o[s]);if(0!==u)return u;var a=eo(n[r[s]],i[o[s]]);if(0!==a)return a}return Hr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function no(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Hr(t,e);var n=oo(t),r=oo(e),i=Hr(n.seconds,r.seconds);return 0!==i?i:Hr(n.nanos,r.nanos)}function ro(t){return io(t)}function io(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=oo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?uo(t.bytesValue).toBase64():"referenceValue"in t?ni.it(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=io(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+io(t.fields[o])}return e+"}"}(t.mapValue):Rr();var e}function oo(t){if(Ur(!!t),"string"==typeof t){var e=0,n=Ji.exec(t);if(Ur(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:so(t.seconds),nanos:so(t.nanos)}}function so(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function uo(t){return"string"==typeof t?fi.fromBase64String(t):fi.fromUint8Array(t)}function ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function co(t){return!!t&&"integerValue"in t}function ho(t){return!!t&&"arrayValue"in t}function fo(t){return!!t&&"nullValue"in t}function lo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function po(t){return!!t&&"mapValue"in t}var vo={asc:"ASCENDING",desc:"DESCENDING"},yo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},go=function(t,e){this.t=t,this.tn=e};function bo(t){return{integerValue:""+t}}function mo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ii(e)?"-0":e}}function wo(t,e){return oi(e)?bo(e):mo(t,e)}function _o(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Io(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Eo(t,e){return _o(t,e.M())}function Oo(t){return Ur(!!t),Jr.N(function(t){var e=oo(t);return new Yr(e.seconds,e.nanos)}(t))}function To(t,e){return function(t){return new Zr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function jo(t){var e=Zr.Y(t);return Ur(Qo(e)),e}function Ao(t,e){return To(t.t,e.path)}function No(t,e){var n=jo(e);if(n.get(1)!==t.t.projectId)throw new Mr(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Mr(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new ni(Do(n))}function ko(t,e){return To(t.t,e)}function xo(t){var e=jo(t);return 4===e.length?Zr.X():Do(e)}function So(t){return new Zr(["projects",t.t.projectId,"databases",t.t.database]).J()}function Do(t){return Ur(t.length>4&&"documents"===t.get(4)),t.B(5)}function Co(t,e,n){return{name:Ao(t,e),fields:n.proto.mapValue.fields}}function Po(t,e){var n;if(e instanceof ms)n={update:Co(t,e.key,e.value)};else if(e instanceof Ts)n={delete:Ao(t,e.key)};else if(e instanceof ws)n={update:Co(t,e.key,e.data),updateMask:Xo(e.en)};else if(e instanceof Is)n={transform:{document:Ao(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof ts)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof es)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof rs)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof os)return{fieldPath:e.field.J(),increment:n.nn};throw Rr()}(0,t)})}};else{if(!(e instanceof js))return Rr();n={verify:Ao(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Eo(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Rr()}(t,e.rn)),n}function Ro(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?fs.updateTime(Oo(t.updateTime)):void 0!==t.exists?fs.exists(t.exists):fs.on()}(e.currentDocument):fs.on();if(e.update){var r=No(t,e.update.name),i=new As({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new as((t.fieldPaths||[]).map(function(t){return ei.nt(t)}))}(e.updateMask);return new ws(r,i,o,n)}return new ms(r,i,n)}if(e.delete){var s=No(t,e.delete);return new Ts(s,n)}if(e.transform){var u=No(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Ur("REQUEST_TIME"===e.setToServerValue),n=new ts):"appendMissingElements"in e?n=new es(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new rs(e.removeAllFromArray.values||[]):"increment"in e?n=new os(t,e.increment):Rr();var r=ei.nt(e.fieldPath);return new cs(r,n)}(t,e)});return Ur(!0===n.exists),new Is(u,a)}if(e.verify){var c=No(t,e.verify);return new js(c,n)}return Rr()}function Uo(t,e){return{documents:[ko(t,e.path)]}}function Lo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ko(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ko(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(lo(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NAN"}};if(fo(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(lo(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NOT_NAN"}};if(fo(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Go(t.field),op:Bo(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Go(t.field),direction:zo(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.tn||ri(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=qo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=qo(e.endAt)),n}function Vo(t){var e=xo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ur(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Mo(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new cu(Ko(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return ri(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Fo(n.startAt));var h=null;return n.endAt&&(h=Fo(n.endAt)),Rs(e,i,u,s,a,"F",c,h)}function Mo(t){return t?void 0!==t.unaryFilter?[Ho(t)]:void 0!==t.fieldFilter?[Wo(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Mo(t)}).reduce(function(t,e){return t.concat(e)}):Rr():[]}function qo(t){return{before:t.before,values:t.position}}function Fo(t){return new ou(t.values||[],!!t.before)}function zo(t){return vo[t]}function Bo(t){return yo[t]}function Go(t){return{fieldPath:t.J()}}function Ko(t){return ei.nt(t.fieldPath)}function Wo(t){return Ys.create(Ko(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ho(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ko(t.unaryFilter.field);return Ys.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ko(t.unaryFilter.field);return Ys.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ko(t.unaryFilter.field);return Ys.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ko(t.unaryFilter.field);return Ys.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}function Xo(t){var e=[];return t.fields.forEach(function(t){return e.push(t.J())}),{fieldPaths:e}}function Qo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Yo=function(){this.cn=void 0};function Jo(t,e,n){return t instanceof ts?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof es?ns(t,e):t instanceof rs?is(t,e):function(t,e){var n=Zo(t,e),r=ss(n)+ss(t.nn);return co(n)&&co(t.nn)?bo(r):mo(t.serializer,r)}(t,e)}function $o(t,e,n){return t instanceof es?ns(t,e):t instanceof rs?is(t,e):n}function Zo(t,e){return t instanceof os?co(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ts=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e}(Yo),es=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(m.d)(e,t),e}(Yo);function ns(t,e){for(var n=us(e),r=function(t){n.some(function(e){return Zi(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var rs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(m.d)(e,t),e}(Yo);function is(t,e){for(var n=us(e),r=function(t){n=n.filter(function(e){return!Zi(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var os=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return Object(m.d)(e,t),e}(Yo);function ss(t){return so(t.integerValue||t.doubleValue)}function us(t){return ho(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var as=function(){function t(t){this.fields=t,t.sort(ei.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return Xr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),cs=function(t,e){this.field=t,this.transform=e},hs=function(t,e){this.version=t,this.transformResults=e},fs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ls(t,e){return void 0!==t.updateTime?e instanceof Ss&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ss}var ps=function(){};function ds(t,e,n){return t instanceof ms?function(t,e,n){return new Ss(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof ws?function(t,e,n){if(!ls(t.rn,e))return new Cs(t.key,n.version);var r=_s(t,e);return new Ss(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Is?function(t,e,n){if(Ur(null!=n.transformResults),!ls(t.rn,e))return new Cs(t.key,n.version);var r=Es(0,e),i=function(t,e,n){var r=[];Ur(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ss&&(u=e.field(o.field)),r.push($o(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Os(t,r.data(),i);return new Ss(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Ds(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function vs(t,e,n,r){return t instanceof ms?function(t,e){if(!ls(t.rn,e))return e;var n=bs(e);return new Ss(t.key,n,t.value,{an:!0})}(t,e):t instanceof ws?function(t,e){if(!ls(t.rn,e))return e;var n=bs(e),r=_s(t,e);return new Ss(t.key,n,r,{an:!0})}(t,e):t instanceof Is?function(t,e,n,r){if(!ls(t.rn,e))return e;var i=Es(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Ss&&(c=n.field(u.field)),null===c&&r instanceof Ss&&(c=r.field(u.field)),i.push(Jo(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Os(t,i.data(),o);return new Ss(t.key,i.version,s,{an:!0})}(t,e,r,n):function(t,e){return ls(t.rn,e)?new Ds(t.key,Jr.min()):e}(t,e)}function ys(t,e){return t instanceof Is?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Ss?e.field(o.field):void 0,u=Zo(o.transform,s||null);null!=u&&(n=null==n?(new Ns).set(o.field,u):n.set(o.field,u))}return n?n.hn():null}(t,e):null}function gs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||Xr(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof es&&e instanceof es||t instanceof rs&&e instanceof rs?Xr(t.elements,e.elements,Zi):t instanceof os&&e instanceof os?Zi(t.nn,e.nn):t instanceof ts&&e instanceof ts}(t.transform,e.transform)}(t,e)}))}function bs(t){return t instanceof Ss?t.version:Jr.min()}var ms=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return Object(m.d)(e,t),e}(ps),ws=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return Object(m.d)(e,t),e}(ps);function _s(t,e){return function(t,e){var n=new Ns(e);return t.en.fields.forEach(function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.hn()}(t,e instanceof Ss?e.data():As.empty())}var Is=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=fs.exists(!0),r}return Object(m.d)(e,t),e}(ps);function Es(t,e){return e}function Os(t,e,n){for(var r=new Ns(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.hn()}var Ts=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return Object(m.d)(e,t),e}(ps),js=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return Object(m.d)(e,t),e}(ps),As=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return Zi(this.proto,t.proto)},t}(),Ns=function(){function t(t){void 0===t&&(t=As.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===$i(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(ei.X(),this._n);return null!=t?new As(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=po(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.dn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function ks(t){var e=[];return Wi(t.fields||{},function(t,n){var r=new ei([t]);if(po(n)){var i=ks(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new as(e)}var xs=function(t,e){this.key=t,this.version=e},Ss=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(m.d)(e,t),e.prototype.field=function(t){return this.wn.field(t)},e.prototype.data=function(){return this.wn},e.prototype.En=function(){return this.wn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(xs),Ds=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(m.d)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(xs),Cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(xs),Ps=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null};function Rs(t,e,n,r,i,o,s,u){return new Ps(t,e,n,r,i,o,s,u)}function Us(t){return new Ps(t)}function Ls(t){return!ri(t.limit)&&"F"===t.limitType}function Vs(t){return!ri(t.limit)&&"L"===t.limitType}function Ms(t){return t.Tn.length>0?t.Tn[0].field:null}function qs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Fs(t){return null!==t.collectionGroup}function zs(t){var e=Lr(t);if(null===e.In){e.In=[];var n=qs(e),r=Ms(e);if(null!==n&&null===r)n.tt()||e.In.push(new cu(n)),e.In.push(new cu(ei.et(),"asc"));else{for(var i=!1,o=0,s=e.Tn;o<s.length;o++){var u=s[o];e.In.push(u),u.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new cu(ei.et(),a))}}}return e.In}function Bs(t){var e=Lr(t);if(!e.mn)if("F"===e.limitType)e.mn=ui(e.path,e.collectionGroup,zs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=zs(e);r<i.length;r++){var o=i[r];n.push(new cu(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new ou(e.endAt.position,!e.endAt.before):null,u=e.startAt?new ou(e.startAt.position,!e.startAt.before):null;e.mn=ui(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.mn}function Gs(t,e,n){return new Ps(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ks(t,e){return ci(Bs(t),Bs(e))&&t.limitType===e.limitType}function Ws(t){return ai(Bs(t))+"|lt:"+t.limitType}function Hs(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.J()+" "+e.op+" "+ro(e.value);var e}).join(", ")+"]"),ri(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+su(t.startAt)),t.endAt&&(e+=", endAt: "+su(t.endAt)),"Target("+e+")"}(Bs(t))+"; limitType="+t.limitType+")"}function Xs(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):ni.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!uu(t.startAt,zs(t),e)||t.endAt&&uu(t.endAt,zs(t),e))}(t,e)}function Qs(t){return function(e,n){for(var r=!1,i=0,o=zs(t);i<o.length;i++){var s=o[i],u=hu(s,e,n);if(0!==u)return u;r=r||s.field.tt()}return 0}}var Ys=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(m.d)(e,t),e.create=function(t,n,r){return t.tt()?"in"===n||"not-in"===n?this.Rn(t,n,r):new Js(t,n,r):"array-contains"===n?new eu(t,r):"in"===n?new nu(t,r):"not-in"===n?new ru(t,r):"array-contains-any"===n?new iu(t,r):new e(t,n,r)},e.Rn=function(t,e,n){return"in"===e?new $s(t,n):new Zs(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(eo(e,this.value)):null!==e&&$i(this.value)===$i(e)&&this.Pn(eo(e,this.value))},e.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Rr()}},e.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Js=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ni.it(r.referenceValue),i}return Object(m.d)(e,t),e.prototype.matches=function(t){var e=ni.$(t.key,this.key);return this.Pn(e)},e}(Ys),$s=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=tu(0,n),r}return Object(m.d)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ys),Zs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=tu(0,n),r}return Object(m.d)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ys);function tu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ni.it(t.referenceValue)})}var eu=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(m.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return ho(e)&&to(e.arrayValue,this.value)},e}(Ys),nu=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(m.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&to(this.value.arrayValue,e)},e}(Ys),ru=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(m.d)(e,t),e.prototype.matches=function(t){if(to(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!to(this.value.arrayValue,e)},e}(Ys),iu=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(m.d)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ho(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return to(e.value.arrayValue,t)})},e}(Ys),ou=function(t,e){this.position=t,this.before=e};function su(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return ro(t)}).join(",")}function uu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.tt()?ni.$(ni.it(s.referenceValue),n.key):eo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function au(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Zi(t.position[n],e.position[n]))return!1;return!0}var cu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function hu(t,e,n){var r=t.field.tt()?ni.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?eo(r,i):Rr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Rr()}}function fu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var lu=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ds(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=vs(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=vs(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},xi())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Xr(this.mutations,t.mutations,function(t,e){return gs(t,e)})&&Xr(this.baseMutations,t.baseMutations,function(t,e){return gs(t,e)})},t}(),pu=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){Ur(e.mutations.length===r.length);for(var i=Ni,o=e.mutations,s=0;s<o.length;s++)i=i.Tt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),du=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.Cn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Wi(this.Nn,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.W=function(){return Hi(this.Nn)},t}(),vu=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&Rr(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t(function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}})},t.prototype.Ln=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn(function(){return e(n)}):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.qn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.qn(r)},t}(),yu=function(){function t(){this.Qn=new du(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:Jr.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?vu.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),gu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};function bu(t){return new go(t,!0)}function mu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var wu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_u=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach(function(t){return t()})},t}(),Iu=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next(function(r){return n.hs(t,e,r)})},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t})},t.prototype.ls=function(t,e,n){var r=Ti();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)}),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next(function(e){return n.fs(t,e)})},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next(function(r){var i=n.ls(t,e,r),o=Oi();return i.forEach(function(t,e){e||(e=new Ds(t,Jr.min())),o=o.Tt(t,e)}),o})},t.prototype.ws=function(t,e,n){return function(t){return ni.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Fs(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new ni(e)).next(function(t){var e=Ai();return t instanceof Ss&&(e=e.Tt(t.key,t)),e})},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=Ai();return this.os.As(t,i).next(function(s){return vu.forEach(s,function(s){var u=function(t,e){return new Ps(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Is(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Tt(t,e)})})}).next(function(){return o})})},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next(function(n){return r=n,o.rs.Rs(t,e)}).next(function(e){return o.Ps(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=vs(a,h,h,o.gn);r=f instanceof Ss?r.Tt(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Xs(e,n)||(r=r.remove(t))}),r})},t.prototype.Ps=function(t,e,n){for(var r=xi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ws&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ss&&(c=c.Tt(t,e))}),c})},t}(),Eu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=xi(),i=xi(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ou=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();Ou.Ds=-1;var Tu=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),ju=function(){function t(e,n,r){this.name=e,this.version=n,this.Ws=r,12.2===t.js(Object(I.j)())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Sr("SimpleDb","Removing database:",t),Du(window.indexedDB.deleteDatabase(t)).Ln()},t.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(t.zs())return!0;var e=Object(I.j)(),n=t.js(e),r=0<n&&n<10,i=t.Hs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},t.Ys=function(t,e){return t.store(e)},t.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Xs=function(t){return Object(m.b)(this,void 0,void 0,function(){var e,n=this;return Object(m.e)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Nu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Mr(Vr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Nu(t,n))},i.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Ws.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Sr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return n.Zs(t)}),this.db)]}})})},t.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(m.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(m.e)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(m.e)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Xs(t)];case 2:return u.db=f.sent(),e=xu.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),vu.reject(t)}).Ln(),a={},s.catch(function(){}),[4,e.ei];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return Sr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Au=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return Du(this.ni.delete())},t}(),Nu=function(t){function e(e,n){var r=this;return(r=t.call(this,Vr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(m.d)(e,t),e}(Mr);function ku(t){return"IndexedDbTransactionError"===t.name}var xu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new gu,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new Nu(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=Pu(e.target.error);n.ci.reject(new Nu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Nu(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Su(e)},t}(),Su=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Du(n)},t.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),Du(this.store.add(t))},t.prototype.get=function(t){var e=this;return Du(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Sr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),Du(this.store.delete(t))},t.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),Du(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.hi=function(t,e){Sr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,function(t,e,n){return n.delete()})},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new vu(function(n,r){e.onerror=function(t){var e=Pu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.ai=function(t,e){var n=[];return new vu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Au(i),s=e(i.primaryKey,i.value,o);if(s instanceof vu){var u=s.catch(function(t){return o.done(),vu.reject(t)});n.push(u)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}}).next(function(){return vu.qn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Du(t){return new vu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Pu(t.target.error);n(e)}})}var Cu=!1;function Pu(t){var e=ju.js(Object(I.j)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Mr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Cu||(Cu=!0,setTimeout(function(){throw r},0)),r}}return t}function Ru(){return"undefined"!=typeof window?window:null}function Uu(){return"undefined"!=typeof document?document:null}var Lu=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new gu,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}return t.Ii=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Mr(Vr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri(function(){return null!==t.mi?(t.clearTimeout(),t.op().then(function(e){return t.Ti.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),Vu=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Tu(this,"async_queue_retry"),this.Di=function(){var e=Uu();e&&Sr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=Uu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=Uu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},t.prototype.ki=function(){return Object(m.b)(this,void 0,void 0,function(){var t,e=this;return Object(m.e)(this,function(n){switch(n.label){case 0:if(0===this.gi.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return n.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!ku(t=n.sent()))throw t;return Sr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs(function(){return e.ki()}),n.label=5;case 5:return[2]}})})},t.prototype.Fi=function(t){var e=this,n=this.Pi.then(function(){return e.vi=!0,t().catch(function(t){throw e.pi=t,e.vi=!1,Dr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.vi=!1,t})});return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=Lu.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&Rr()},t.prototype.Li=function(){},t.prototype.Bi=function(){return Object(m.b)(this,void 0,void 0,function(){var t;return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then(function(){e.Vi.sort(function(t,e){return t.wi-e.wi});for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()})},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function Mu(t,e){if(Dr("AsyncQueue",e+": "+t),ku(t))return new Mr(Vr.UNAVAILABLE,e+": "+t);throw t}function qu(t,e){var n=t[1],r=e[1],i=Hr(t[0],e[0]);return 0===i?Hr(n,r):i}var Fu=function(){function t(t){this.Ki=t,this.buffer=new _i(qu),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();qu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),zu={zi:!1,Hi:0,Ji:0,Yi:0},Bu=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();Bu.nr=10,Bu.sr=1e3,Bu.ir=new Bu(41943040,Bu.nr,Bu.sr),Bu.rr=new Bu(-1,0,0);var Gu=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var e=this,n=this.ur?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ar=this.di.Us("lru_garbage_collection",n,function(){return Object(m.b)(e,void 0,void 0,function(){var e;return Object(m.e)(this,function(n){switch(n.label){case 0:this.ar=null,this.ur=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return n.sent(),[3,7];case 3:return ku(e=n.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,gc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return n.sent(),[2]}})})})},t}(),Ku=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Tr=function(t,e){var n=this;if(0===e)return vu.resolve(Ou.Ds);var r=new Fu(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),vu.resolve(zu)):this.Pr(t).next(function(r){return r<n.params.Xi?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),zu):n.gr(t,e)})},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.wr(t,this.params.Zi).next(function(e){return e>c.params.tr?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.tr+" from "+e),r=c.params.tr):r=e,o=Date.now(),c.Tr(t,r)}).next(function(r){return n=r,s=Date.now(),c.mr(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Ar(t,n)}).next(function(t){return a=Date.now(),xr()<=_.a.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),vu.resolve({zi:!0,Hi:r,Ji:i,Yi:t})})},t}();function Wu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Xu(e)),e=Hu(t.get(n),e);return Xu(e)}function Hu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Xu(t){return t+"\x01\x01"}function Qu(t){var e=t.length;if(Ur(e>=2),2===e)return Ur("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Zr.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Rr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Rr()}o=s+2}return new Zr(r)}var Yu=function(t){this.yr=t};function Ju(t,e){if(e.document)return function(t,e,n){var r=No(t,e.name),i=Oo(e.updateTime),o=new As({mapValue:{fields:e.fields}});return new Ss(r,i,o,{hasCommittedMutations:!!n})}(t.yr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ni.ct(e.noDocument.path),r=na(e.noDocument.readTime);return new Ds(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=ni.ct(e.unknownDocument.path),o=na(e.unknownDocument.version);return new Cs(i,o)}return Rr()}function $u(t,e,n){var r=Zu(n),i=e.key.path.q().H();if(e instanceof Ss){var o=function(t,e){return{name:Ao(t,e.key),fields:e.En().mapValue.fields,updateTime:_o(t,e.version.M())}}(t.yr,e);return new ka(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof Ds){var s=e.key.path.H(),u=ea(e.version),a=e.hasCommittedMutations;return new ka(null,new Aa(s,u),null,a,r,i)}if(e instanceof Cs){var c=e.key.path.H(),h=ea(e.version);return new ka(new Na(c,h),null,null,!0,r,i)}return Rr()}function Zu(t){var e=t.M();return[e.seconds,e.nanoseconds]}function ta(t){var e=new Yr(t[0],t[1]);return Jr.N(e)}function ea(t){var e=t.M();return new Ia(e.seconds,e.nanoseconds)}function na(t){var e=new Yr(t.seconds,t.nanoseconds);return Jr.N(e)}function ra(t,e){var n=(e.baseMutations||[]).map(function(e){return Ro(t.yr,e)}),r=e.mutations.map(function(e){return Ro(t.yr,e)}),i=Yr.fromMillis(e.localWriteTimeMs);return new lu(e.batchId,i,n,r)}function ia(t){var e,n,r=na(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?na(t.lastLimboFreeSnapshotVersion):Jr.min();return void 0!==t.query.documents?(Ur(1===(n=t.query).documents.length),e=Bs(Us(xo(n.documents[0])))):e=function(t){return Bs(Vo(t))}(t.query),new di(e,t.targetId,0,t.lastListenSequenceNumber,r,i,fi.fromBase64String(t.resumeToken))}function oa(t,e){var n,r=ea(e.ft),i=ea(e.lastLimboFreeSnapshotVersion);n=hi(e.target)?Uo(t.yr,e.target):Lo(t.yr,e.target);var o=e.resumeToken.toBase64();return new Sa(e.targetId,ai(e.target),r,o,e.sequenceNumber,i,n)}function sa(t){var e=Vo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Gs(e,e.limit,"L"):e}var ua=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}return t.vr=function(e,n,r,i){return Ur(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.br=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ha(t)._i({index:Ta.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Sr=function(t,e,n,r){var i=this,o=fa(t),s=ha(t);return s.add({}).next(function(u){Ur("number"==typeof u);for(var a=new lu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Po(t.yr,e)}),i=n.mutations.map(function(e){return Po(t.yr,e)});return new Ta(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new _i(function(t,e){return Hr(t.J(),e.J())}),l=0,p=r;l<p.length;l++){var d=p[l],v=ja.key(i.userId,d.key.path,u);f=f.add(d.key.path.q()),h.push(s.put(c)),h.push(o.put(v,ja.PLACEHOLDER))}return f.forEach(function(e){h.push(i.os.Dr(t,e))}),t.es(function(){i.pr[u]=a.keys()}),vu.qn(h).next(function(){return a})})},t.prototype.Cr=function(t,e){var n=this;return ha(t).get(e).next(function(t){return t?(Ur(t.userId===n.userId),ra(n.serializer,t)):null})},t.prototype.Nr=function(t,e){var n=this;return this.pr[e]?vu.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){var r=t.keys();return n.pr[e]=r,r}return null})},t.prototype.Fr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ha(t)._i({index:Ta.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Ur(e.batchId>=r),o=ra(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ha(t)._i({index:Ta.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ha(t).ui(Ta.userMutationsIndex,n).next(function(t){return t.map(function(t){return ra(e.serializer,t)})})},t.prototype.us=function(t,e){var n=this,r=ja.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return fa(t)._i({range:i},function(r,i,s){var u=r[0],a=r[2],c=Qu(r[1]);if(u===n.userId&&e.path.isEqual(c))return ha(t).get(a).next(function(t){if(!t)throw Rr();Ur(t.userId===n.userId),o.push(ra(n.serializer,t))});s.done()}).next(function(){return o})},t.prototype.ds=function(t,e){var n=this,r=new _i(Hr),i=[];return e.forEach(function(e){var o=ja.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=fa(t)._i({range:s},function(t,i,o){var s=t[0],u=t[2],a=Qu(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),vu.qn(i).next(function(){return n.kr(t,r)})},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=ja.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new _i(Hr);return fa(t)._i({range:s},function(t,e,o){var s=t[0],a=t[2],c=Qu(t[1]);s===n.userId&&r.j(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.kr(t,u)})},t.prototype.kr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(ha(t).get(e).next(function(t){if(null===t)throw Rr();Ur(t.userId===n.userId),r.push(ra(n.serializer,t))}))}),vu.qn(i).next(function(){return r})},t.prototype.$r=function(t,e){var n=this;return ca(t.Lr,this.userId,e).next(function(r){return t.es(function(){n.Br(e.batchId)}),vu.forEach(r,function(e){return n.Vr.qr(t,e)})})},t.prototype.Br=function(t){delete this.pr[t]},t.prototype.Ur=function(t){var e=this;return this.br(t).next(function(n){if(!n)return vu.resolve();var r=IDBKeyRange.lowerBound(ja.prefixForUser(e.userId)),i=[];return fa(t)._i({range:r},function(t,n,r){if(t[0]===e.userId){var o=Qu(t[1]);i.push(o)}else r.done()}).next(function(){Ur(0===i.length)})})},t.prototype.Qr=function(t,e){return aa(t,this.userId,e)},t.prototype.Kr=function(t){var e=this;return la(t).get(this.userId).next(function(t){return t||new Oa(e.userId,-1,"")})},t}();function aa(t,e,n){var r=ja.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return fa(t)._i({range:o,li:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function ca(t,e,n){var r=t.store(Ta.store),i=t.store(ja.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r._i({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Ur(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=ja.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return vu.qn(o).next(function(){return c})}function ha(t){return $a.Ys(t,Ta.store)}function fa(t){return $a.Ys(t,ja.store)}function la(t){return $a.Ys(t,Oa.store)}var pa=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return ya(t).put(ga(e),n)},t.prototype.Hn=function(t,e){var n=ya(t),r=ga(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Wr(t,r)})},t.prototype.Jn=function(t,e){var n=this;return ya(t).get(ga(e)).next(function(t){return n.jr(t)})},t.prototype.Gr=function(t,e){var n=this;return ya(t).get(ga(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:ba(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Ti();return this.zr(t,e,function(t,e){var i=n.jr(e);r=r.Tt(t,i)}).next(function(){return r})},t.prototype.Hr=function(t,e){var n=this,r=Ti(),i=new bi(ni.$);return this.zr(t,e,function(t,e){var o=n.jr(e);o?(r=r.Tt(t,o),i=i.Tt(t,ba(e))):(r=r.Tt(t,null),i=i.Tt(t,0))}).next(function(){return{Jr:r,Yr:i}})},t.prototype.zr=function(t,e,n){if(e.W())return vu.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return ya(t)._i({range:r},function(t,e,r){for(var s=ni.ct(t);o&&ni.$(o,s)<0;)n(o,null),o=i.Ct();o&&o.isEqual(s)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()}).next(function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null})},t.prototype.ws=function(t,e,n){var r=this,i=Ai(),o=e.path.length+1,s={};if(n.isEqual(Jr.min())){var u=e.path.H();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.H(),c=Zu(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=ka.collectionReadTimeIndex}return ya(t)._i(s,function(t,n,s){if(t.length===o){var u=Ju(r.serializer,n);e.path.j(u.key.path)?u instanceof Ss&&Xs(e,u)&&(i=i.Tt(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Xr=function(t){return new da(this,!!t&&t.Zr)},t.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return va(t).get(xa.key).next(function(t){return Ur(!!t),t})},t.prototype.Wr=function(t,e){return va(t).put(xa.key,e)},t.prototype.jr=function(t){if(t){var e=Ju(this.serializer,t);return e instanceof Ds&&e.version.isEqual(Jr.min())?null:e}return null},t}(),da=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).no=e,r.Zr=n,r.so=new du(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(m.d)(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new _i(function(t,e){return Hr(t.J(),e.J())});return this.Qn.forEach(function(o,s){var u=e.so.get(o);if(s.zn){var a=$u(e.no.serializer,s.zn,e.Wn(o));i=i.add(o.path.q());var c=ba(a);r+=c-u,n.push(e.no.jn(t,o,a))}else if(r-=u,e.Zr){var h=$u(e.no.serializer,new Ds(o,Jr.min()),e.Wn(o));n.push(e.no.jn(t,o,h))}else n.push(e.no.Hn(t,o))}),i.forEach(function(r){n.push(e.no.os.Dr(t,r))}),n.push(this.no.updateMetadata(t,r)),vu.qn(n)},e.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},e.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},e}(yu);function va(t){return $a.Ys(t,xa.store)}function ya(t){return $a.Ys(t,ka.store)}function ga(t){return t.path.H()}function ba(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr();e=t.noDocument}return JSON.stringify(e).length}var ma=function(){function t(){this.io=new wa}return t.prototype.Dr=function(t,e){return this.io.add(e),vu.resolve()},t.prototype.As=function(t,e){return vu.resolve(this.io.getEntries(e))},t}(),wa=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new _i(Zr.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new _i(Zr.$)).H()},t}(),_a=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Ur(n<r&&n>=0&&r<=11);var o=new xu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ea.store)}(t),function(t){t.createObjectStore(Oa.store,{keyPath:Oa.keyPath}),t.createObjectStore(Ta.store,{keyPath:Ta.keyPath,autoIncrement:!0}).createIndex(Ta.userMutationsIndex,Ta.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ja.store)}(t),Ra(t),function(t){t.createObjectStore(ka.store)}(t));var s=vu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Da.store),t.deleteObjectStore(Sa.store),t.deleteObjectStore(Ca.store)}(t),Ra(t)),s=s.next(function(){return function(t){var e=t.store(Ca.store),n=new Ca(0,0,Jr.min().M(),0);return e.put(Ca.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Ta.store).ui().next(function(n){t.deleteObjectStore(Ta.store),t.createObjectStore(Ta.store,{keyPath:Ta.keyPath,autoIncrement:!0}).createIndex(Ta.userMutationsIndex,Ta.userMutationsKeyPath,{unique:!0});var r=e.store(Ta.store),i=n.map(function(t){return r.put(t)});return vu.qn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(xa.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ka.store);e.createIndex(ka.readTimeIndex,ka.readTimeIndexPath,{unique:!1}),e.createIndex(ka.collectionReadTimeIndex,ka.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(La.store,{keyPath:La.keyPath})}(t),function(t){t.createObjectStore(Va.store,{keyPath:Va.keyPath})}(t)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(ka.store)._i(function(t,n){e+=ba(n)}).next(function(){var n=new xa(e);return t.store(xa.store).put(xa.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Oa.store),r=t.store(Ta.store);return n.ui().next(function(n){return vu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(Ta.userMutationsIndex,i).next(function(r){return vu.forEach(r,function(r){Ur(r.userId===n.userId);var i=ra(e.serializer,r);return ca(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Da.store),n=t.store(ka.store);return t.store(Ca.store).get(Ca.key).next(function(t){var r=[];return n._i(function(n,i){var o=new Zr(n),s=function(t){return[0,Wu(t)]}(o);r.push(e.get(s).next(function(n){return n?vu.resolve():function(n){return e.put(new Da(0,Wu(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return vu.qn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Pa.store,{keyPath:Pa.keyPath});var n=e.store(Pa.store),r=new wa,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:Wu(i)})}};return e.store(ka.store)._i({li:!0},function(t,e){var n=new Zr(t);return i(n.q())}).next(function(){return e.store(ja.store)._i({li:!0},function(t,e){var n=Qu(t[1]);return i(n.q())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Sa.store);return n._i(function(t,r){var i=ia(r),o=oa(e.serializer,i);return n.put(o)})},t}(),Ia=function(t,e){this.seconds=t,this.nanoseconds=e},Ea=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ea.store="owner",Ea.key="owner";var Oa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Oa.store="mutationQueues",Oa.keyPath="userId";var Ta=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ta.store="mutations",Ta.keyPath="batchId",Ta.userMutationsIndex="userMutationsIndex",Ta.userMutationsKeyPath=["userId","batchId"];var ja=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Wu(e)]},t.key=function(t,e,n){return[t,Wu(e),n]},t}();ja.store="documentMutations",ja.PLACEHOLDER=new ja;var Aa=function(t,e){this.path=t,this.readTime=e},Na=function(t,e){this.path=t,this.version=e},ka=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ka.store="remoteDocuments",ka.readTimeIndex="readTimeIndex",ka.readTimeIndexPath="readTime",ka.collectionReadTimeIndex="collectionReadTimeIndex",ka.collectionReadTimeIndexPath=["parentPath","readTime"];var xa=function(t){this.byteSize=t};xa.store="remoteDocumentGlobal",xa.key="remoteDocumentGlobalKey";var Sa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sa.store="targets",Sa.keyPath="targetId",Sa.queryTargetsIndexName="queryTargetsIndex",Sa.queryTargetsKeyPath=["canonicalId","targetId"];var Da=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Da.store="targetDocuments",Da.keyPath=["targetId","path"],Da.documentTargetsIndex="documentTargetsIndex",Da.documentTargetsKeyPath=["path","targetId"];var Ca=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ca.key="targetGlobalKey",Ca.store="targetGlobal";var Pa=function(t,e){this.collectionId=t,this.parent=e};function Ra(t){t.createObjectStore(Da.store,{keyPath:Da.keyPath}).createIndex(Da.documentTargetsIndex,Da.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}).createIndex(Sa.queryTargetsIndexName,Sa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ca.store)}Pa.store="collectionParents",Pa.keyPath=["collectionId","parent"];var Ua=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ua.store="clientMetadata",Ua.keyPath="clientId";var La=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};La.store="bundles",La.keyPath="bundleId";var Va=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Va.store="namedQueries",Va.keyPath="name";var Ma=Object(m.j)(Object(m.j)(Object(m.j)(Object(m.j)([Oa.store,Ta.store,ja.store,ka.store,Sa.store,Ea.store,Ca.store,Da.store],[Ua.store]),[xa.store]),[Pa.store]),[La.store,Va.store]),qa=function(){function t(t){this.serializer=t}return t.prototype.ro=function(t,e){return Fa(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:na(e.createTime),version:e.version};var e})},t.prototype.oo=function(t,e){return Fa(t).put({bundleId:(n=e).id,createTime:ea(Oo(n.createTime)),version:n.version});var n},t.prototype.co=function(t,e){return za(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:sa(e.bundledQuery),readTime:na(e.readTime)};var e})},t.prototype.uo=function(t,e){return za(t).put(function(t){return{name:t.name,readTime:ea(Oo(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Fa(t){return $a.Ys(t,La.store)}function za(t){return $a.Ys(t,Va.store)}var Ba=function(){function t(){this.ao=new wa}return t.prototype.Dr=function(t,e){var n=this;if(!this.ao.has(e)){var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});var o={collectionId:r,parent:Wu(i)};return Ga(t).put(o)}return vu.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Qr(e),""],!1,!0);return Ga(t).ui(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Qu(o.parent))}return n})},t}();function Ga(t){return $a.Ys(t,Pa.store)}var Ka=function(){function t(t){this.ho=t}return t.prototype.next=function(){return this.ho+=2,this.ho},t.lo=function(){return new t(0)},t._o=function(){return new t(-1)},t}(),Wa=function(){function t(t,e){this.Vr=t,this.serializer=e}return t.prototype.fo=function(t){var e=this;return this.wo(t).next(function(n){var r=new Ka(n.highestTargetId);return n.highestTargetId=r.next(),e.Eo(t,n).next(function(){return n.highestTargetId})})},t.prototype.To=function(t){return this.wo(t).next(function(t){return Jr.N(new Yr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.mo=function(t,e,n){var r=this;return this.wo(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Eo(t,i)})},t.prototype.Ao=function(t,e){var n=this;return this.Ro(t,e).next(function(){return n.wo(t).next(function(r){return r.targetCount+=1,n.Po(e,r),n.Eo(t,r)})})},t.prototype.yo=function(t,e){return this.Ro(t,e)},t.prototype.Vo=function(t,e){var n=this;return this.po(t,e.targetId).next(function(){return Ha(t).delete(e.targetId)}).next(function(){return n.wo(t)}).next(function(e){return Ur(e.targetCount>0),e.targetCount-=1,n.Eo(t,e)})},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return Ha(t)._i(function(s,u){var a=ia(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Vo(t,a)))}).next(function(){return vu.qn(o)}).next(function(){return i})},t.prototype.Ue=function(t,e){return Ha(t)._i(function(t,n){var r=ia(n);e(r)})},t.prototype.wo=function(t){return Xa(t).get(Ca.key).next(function(t){return Ur(null!==t),t})},t.prototype.Eo=function(t,e){return Xa(t).put(Ca.key,e)},t.prototype.Ro=function(t,e){return Ha(t).put(oa(this.serializer,e))},t.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},t.prototype.bo=function(t,e){var n=ai(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ha(t)._i({range:r,index:Sa.queryTargetsIndexName},function(t,n,r){var o=ia(n);ci(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.So=function(t,e,n){var r=this,i=[],o=Qa(t);return e.forEach(function(e){var s=Wu(e.path);i.push(o.put(new Da(n,s))),i.push(r.Vr.Do(t,n,e))}),vu.qn(i)},t.prototype.Co=function(t,e,n){var r=this,i=Qa(t);return vu.forEach(e,function(e){var o=Wu(e.path);return vu.qn([i.delete([n,o]),r.Vr.No(t,n,e)])})},t.prototype.po=function(t,e){var n=Qa(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Qa(t),i=xi();return r._i({range:n,li:!0},function(t,e,n){var r=Qu(t[1]),o=new ni(r);i=i.add(o)}).next(function(){return i})},t.prototype.Qr=function(t,e){var n=Wu(e.path),r=IDBKeyRange.bound([n],[Qr(n)],!1,!0),i=0;return Qa(t)._i({index:Da.documentTargetsIndex,li:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Ze=function(t,e){return Ha(t).get(e).next(function(t){return t?ia(t):null})},t}();function Ha(t){return $a.Ys(t,Sa.store)}function Xa(t){return $a.Ys(t,Ca.store)}function Qa(t){return $a.Ys(t,Da.store)}var Ya="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ja=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Lr=e,r.Fo=n,r}return Object(m.d)(e,t),e}(_u),$a=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=s,this.document=u,this.Oo=c,this.Mo=h,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!t.Gs())throw new Mr(Vr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new ec(this,i),this.Ko=n+"main",this.serializer=new Yu(a),this.Wo=new ju(this.Ko,11,new _a(this.serializer)),this.jo=new Wa(this.Vr,this.serializer),this.os=new Ba,this.ss=function(t,e){return new pa(t,e)}(this.serializer,this.os),this.Go=new qa(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===h&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof Ja)return ju.Ys(t.Lr,e);throw Rr()},t.prototype.start=function(){var t=this;return this.Ho().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Mr(Vr.FAILED_PRECONDITION,Ya);return t.Jo(),t.Yo(),t.Xo(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.jo.Io(e)})}).then(function(e){t.ko=new Ou(e,t.Oo)}).then(function(){t.$o=!0}).catch(function(e){return t.Wo&&t.Wo.close(),Promise.reject(e)})},t.prototype.Zo=function(t){var e=this;return this.Qo=function(n){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){return this.lr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.tc=function(t){var e=this;this.Wo.ti(function(n){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Ho=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return tc(e).put(new Ua(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.nc(e).next(function(e){e||(t.isPrimary=!1,t.Cs.Mi(function(){return t.Qo(!1)}))})}).next(function(){return t.sc(e)}).next(function(n){return t.isPrimary&&!n?t.ic(e).next(function(){return!1}):!!n&&t.rc(e).next(function(){return!0})})}).catch(function(e){if(ku(e))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Cs.Mi(function(){return t.Qo(e)}),t.isPrimary=e})},t.prototype.nc=function(t){var e=this;return Za(t).get(Ea.key).next(function(t){return vu.resolve(e.oc(t))})},t.prototype.cc=function(t){return tc(t).delete(this.clientId)},t.prototype.uc=function(){return Object(m.b)(this,void 0,void 0,function(){var e,n,r,i=this;return Object(m.e)(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Ys(e,Ua.store);return n.ui().next(function(t){var e=i.hc(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return vu.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=o.sent(),this.zo)for(n=0,r=e;n<r.length;n++)this.zo.removeItem(this.lc(r[n].clientId));o.label=2;case 2:return[2]}})})},t.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},t.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sc=function(t){var e=this;return this.Mo?vu.resolve(!0):Za(t).get(Ea.key).next(function(n){if(null!==n&&e.ac(n.leaseTimestampMs,5e3)&&!e._c(n.ownerId)){if(e.oc(n)&&e.networkEnabled)return!0;if(!e.oc(n)){if(!n.allowTabSynchronization)throw new Mr(Vr.FAILED_PRECONDITION,Ya);return!1}}return!(!e.networkEnabled||!e.inForeground)||tc(t).ui().next(function(t){return void 0===e.hc(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.fc=function(){return Object(m.b)(this,void 0,void 0,function(){var t=this;return Object(m.e)(this,function(e){switch(e.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Ea.store,Ua.store],function(e){var n=new Ja(e,Ou.Ds);return t.ic(n).next(function(){return t.cc(n)})})];case 1:return e.sent(),this.Wo.close(),this.Tc(),[2]}})})},t.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},t.prototype.Ic=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return tc(e).ui().next(function(e){return t.hc(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return ua.vr(t,this.serializer,this.os,this.Vr)},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.Pc=function(){return this.os},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Sr("IndexedDbPersistence","Starting transaction:",t),this.Wo.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ma,function(o){return r=new Ja(o,i.ko?i.ko.next():Ou.Ds),"readwrite-primary"===e?i.nc(r).next(function(t){return!!t||i.sc(r)}).next(function(e){if(!e)throw Dr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new Mr(Vr.FAILED_PRECONDITION,wu);return n(r)}).next(function(t){return i.rc(r).next(function(){return t})}):i.yc(r).next(function(){return n(r)})}).then(function(t){return r.ns(),t})},t.prototype.yc=function(t){var e=this;return Za(t).get(Ea.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Mr(Vr.FAILED_PRECONDITION,Ya)})},t.prototype.rc=function(t){var e=new Ea(this.clientId,this.allowTabSynchronization,Date.now());return Za(t).put(Ea.key,e)},t.Gs=function(){return ju.Gs()},t.prototype.ic=function(t){var e=this,n=Za(t);return n.get(Ea.key).next(function(t){return e.oc(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(Ea.key)):vu.resolve()})},t.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},t.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},t.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},t.prototype._c=function(t){var e;try{var n=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},t.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},t.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Za(t){return $a.Ys(t,Ea.store)}function tc(t){return $a.Ys(t,Ua.store)}var ec=function(){function t(t,e){this.db=t,this.cr=new Ku(this,e)}return t.prototype.Er=function(t){var e=this.Vc(t);return this.db.Ac().vo(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},t.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},t.prototype.Ir=function(t,e){return this.vc(t,function(t,n){return e(n)})},t.prototype.Do=function(t,e,n){return nc(t,n)},t.prototype.No=function(t,e,n){return nc(t,n)},t.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},t.prototype.qr=function(t,e){return nc(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return la(t).fi(function(r){return aa(t,r,e).next(function(t){return t&&(n=!0),vu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.Rc().Xr(),i=[],o=0;return this.vc(t,function(s,u){if(u<=e){var a=n.bc(t,s).next(function(e){if(!e)return o++,r.Jn(t,s).next(function(){return r.Hn(s),Qa(t).delete([0,Wu(s.path)])})});i.push(a)}}).next(function(){return vu.qn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Fo);return this.db.Ac().yo(t,n)},t.prototype.Sc=function(t,e){return nc(t,e)},t.prototype.vc=function(t,e){var n,r=Qa(t),i=Ou.Ds;return r._i({index:Da.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Ou.Ds&&e(new ni(Qu(n)),i),i=s,n=o):i=Ou.Ds}).next(function(){i!==Ou.Ds&&e(new ni(Qu(n)),i)})},t.prototype.Pr=function(t){return this.db.Rc().eo(t)},t}();function nc(t,e){return Qa(t).put(function(t,e){return new Da(0,Wu(t.path),e)}(e,t.Fo))}function rc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ic=function(){function t(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new bi(Hr),this.Nc=new du(function(t){return ai(t)},ci),this.xc=Jr.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new Iu(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Rr(n,e.Cc)})},t}();function oc(t,e,n,r){return new ic(t,e,n,r)}function sc(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(m.e)(this,function(s){switch(s.label){case 0:return n=Lr(t),r=n.rs,i=n.Oc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.rs.Mr(t).next(function(s){return o=s,r=n.persistence.mc(e),i=new Iu(n.Fc,r,n.persistence.Pc()),r.Mr(t)}).next(function(e){for(var n=[],r=[],s=xi(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i._s(t,s).next(function(t){return{kc:t,$c:n,Lc:r}})})})];case 1:return o=s.sent(),[2,(n.rs=r,n.Oc=i,n.Dc.Mc(n.Oc),o)]}})})}function uc(t,e){var n=Lr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Fc.Xr({Zr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=vu.resolve();return o.forEach(function(t){s=s.next(function(){return r.Jn(e,t)}).next(function(e){var o=e,s=n.Sn.get(t);Ur(null!==s),(!o||o.version.F(s)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)})}),s.next(function(){return t.rs.$r(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}function ac(t){var e=Lr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function cc(t,e){var n=Lr(t),r=e.ft,i=n.Cc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Fc.Xr({Zr:!0});i=n.Cc;var s=[];e.re.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.jo.Co(t,e.de,o).next(function(){return n.jo.So(t,e._e,o)}));var a=e.resumeToken;if(a.ht()>0){var c=u.wt(a,r).dt(t.Fo);i=i.Tt(o,c),function(t,e,n){return Ur(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(u,c,e)&&s.push(n.jo.yo(t,c))}}});var u=Oi();if(e.ce.forEach(function(r,i){e.ue.has(r)&&s.push(n.persistence.Vr.Sc(t,r))}),s.push(function(t,e,n,r,i){var o=xi();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var i=Oi();return n.forEach(function(n,o){var s=t.get(n),u=r;o instanceof Ds&&o.version.isEqual(Jr.min())?(e.Hn(n,u),i=i.Tt(n,o)):null==s||o.version.F(s.version)>0||0===o.version.F(s.version)&&s.hasPendingWrites?(e.jn(o,u),i=i.Tt(n,o)):Sr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)}),i})}(t,o,e.ce,r).next(function(t){u=t})),!r.isEqual(Jr.min())){var a=n.jo.To(t).next(function(e){return n.jo.mo(t,t.Fo,r)});s.push(a)}return vu.qn(s).next(function(){return o.apply(t)}).next(function(){return n.Oc.fs(t,u)})}).then(function(t){return n.Cc=i,t})}function hc(t,e){var n=Lr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.rs.Fr(t,e)})}function fc(t,e){var n=Lr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.jo.bo(t,e).next(function(i){return i?vu.resolve(r=i):n.jo.fo(t).next(function(i){return r=new di(e,i,0,t.Fo),n.jo.Ao(t,r).next(function(){return r})})})}).then(function(t){var r=n.Cc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Cc=n.Cc.Tt(t.targetId,t),n.Nc.set(e,t.targetId)),t})}function lc(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:r=Lr(t),i=r.Cc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Vr.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!ku(s=u.sent()))throw s;return Sr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Cc=r.Cc.remove(e),r.Nc.delete(i.target),[2]}})})}function pc(t,e,n){var r=Lr(t),i=Jr.min(),o=xi();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Lr(t),i=r.Nc.get(n);return void 0!==i?vu.resolve(r.Cc.get(i)):r.jo.bo(e,n)}(r,t,Bs(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.jo.xo(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Dc.ws(t,e,n?i:Jr.min(),n?o:xi())}).next(function(t){return{documents:t,Bc:o}})})}function dc(t,e){var n=Lr(t),r=Lr(n.jo),i=n.Cc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function vc(t){var e=Lr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Lr(t),i=Oi(),o=Zu(n),s=ya(e),u=IDBKeyRange.lowerBound(o,!0);return s._i({index:ka.readTimeIndex,range:u},function(t,e){var n=Ju(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:ta(o)}})}(e.Fc,t,e.xc)}).then(function(t){var n=t.qc;return e.xc=t.readTime,n})}function yc(t){return Object(m.b)(this,void 0,void 0,function(){var e;return Object(m.e)(this,function(n){return[2,(e=Lr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=ya(t),n=Jr.min();return e._i({index:ka.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=ta(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.xc=t})]})})}function gc(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){if(t.code!==Vr.FAILED_PRECONDITION||t.message!==wu)throw t;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var bc=function(){function t(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new Tu(t,e)}return t.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.zc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Hc()},t.prototype.stop=function(){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Jc=function(){this.state=0,this.Si.reset()},t.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},t.prototype.Zc=function(t){this.tu(),this.stream.send(t)},t.prototype.Xc=function(){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},t.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},t.prototype.close=function(t,e){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(n){switch(n.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==t?this.Si.reset():e&&e.code===Vr.RESOURCE_EXHAUSTED?(Dr(e.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===Vr.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.nu(e)];case 1:return n.sent(),[2]}})})},t.prototype.eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.su(this.Wc),n=this.Wc;this.Kc.getToken().then(function(e){t.Wc===n&&t.iu(e)},function(n){e(function(){var e=new Mr(Vr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.ru(e)})})},t.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return Object(m.b)(t,void 0,void 0,function(){return Object(m.e)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.ru=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.su=function(t){var e=this;return function(n){e.Cs.Ri(function(){return e.Wc===t?n():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),mc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return Object(m.d)(e,t),e.prototype.ou=function(t){return this.Qc.uu("Listen",t)},e.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Rr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(Ur(void 0===e||"string"==typeof e),fi.fromBase64String(e||"")):(Ur(void 0===e||e instanceof Uint8Array),fi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?Vr.UNKNOWN:gi(t.code);return new Mr(e,t.message||"")}(s);n=new qi(r,i,o,u||null)}else if("documentChange"in e){var a=e.documentChange,c=No(t,a.document.name),h=Oo(a.document.updateTime),f=new As({mapValue:{fields:a.document.fields}}),l=new Ss(c,h,f,{});n=new Vi(a.targetIds||[],a.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=No(t,p.document),v=p.readTime?Oo(p.readTime):Jr.min(),y=new Ds(d,v);n=new Vi([],p.removedTargetIds||[],y.key,y)}else if("documentRemove"in e){var g=e.documentRemove,b=No(t,g.document);n=new Vi([],g.removedTargetIds||[],b,null)}else{if(!("filter"in e))return Rr();var m=e.filter,w=new vi(m.count||0);n=new Mi(m.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Jr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Jr.min():e.readTime?Oo(e.readTime):Jr.min()}(t);return this.listener.au(e,n)},e.prototype.hu=function(t){var e={};e.database=So(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=hi(r)?{documents:Uo(t,r)}:{query:Lo(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=Io(t,e.resumeToken):e.ft.F(Jr.min())>0&&(n.readTime=_o(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.Zc(e)},e.prototype.lu=function(t){var e={};e.database=So(this.serializer),e.removeTarget=t,this.Zc(e)},e}(bc),wc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s._u=!1,s}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.eu=function(){this._u&&this.du([])},e.prototype.ou=function(t){return this.Qc.uu("Write",t)},e.prototype.onMessage=function(t){if(Ur(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=function(t,e){return t&&t.length>0?(Ur(void 0!==e),t.map(function(t){return function(t,e){var n=Oo(t.updateTime?t.updateTime:e);n.isEqual(Jr.min())&&(n=Oo(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new hs(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Oo(t.commitTime);return this.listener.wu(n,e)}return Ur(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},e.prototype.Tu=function(){var t={};t.database=So(this.serializer),this.Zc(t)},e.prototype.du=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Po(e.serializer,t)})};this.Zc(n)},e}(bc),_c=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qc=n,i.serializer=r,i.Iu=!1,i}return Object(m.d)(e,t),e.prototype.mu=function(){if(this.Iu)throw new Mr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Au=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Au(t,e,n,i)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.Ru=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Ru(t,e,n,i)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.terminate=function(){this.Iu=!1},e}(function(){}),Ic=function(){function t(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}return t.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},t.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,this.gu>=1&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},t.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},t.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},t.prototype.bu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(Dr(e),this.Vu=!1):Sr("OnlineStateTracker",e)},t.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},t}(),Ec=function(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return Object(m.b)(o,void 0,void 0,function(){return Object(m.e)(this,function(t){switch(t.label){case 0:return Dc(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(m.b)(this,void 0,void 0,function(){var e;return Object(m.e)(this,function(n){switch(n.label){case 0:return(e=Lr(t)).Mu.add(4),[4,Tc(e)];case 1:return n.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,Oc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new Ic(n,r)};function Oc(t){return Object(m.b)(this,void 0,void 0,function(){var e,n;return Object(m.e)(this,function(r){switch(r.label){case 0:if(!Dc(t))return[3,4];e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Tc(t){return Object(m.b)(this,void 0,void 0,function(){var e,n;return Object(m.e)(this,function(r){switch(r.label){case 0:e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function jc(t,e){var n=Lr(t);n.Ou.has(e.targetId)||(n.Ou.set(e.targetId,e),Sc(n)?xc(n):Hc(n).zc()&&Nc(n,e))}function Ac(t,e){var n=Lr(t),r=Hc(n);n.Ou.delete(e),r.zc()&&kc(n,e),0===n.Ou.size&&(r.zc()?r.Yc():Dc(n)&&n.Bu.set("Unknown"))}function Nc(t,e){t.qu.De(e.targetId),Hc(t).hu(e)}function kc(t,e){t.qu.De(e),Hc(t).lu(e)}function xc(t){t.qu=new zi({Xe:function(e){return t.xu.Xe(e)},Ze:function(e){return t.Ou.get(e)||null}}),Hc(t).start(),t.Bu.pu()}function Sc(t){return Dc(t)&&!Hc(t).Gc()&&t.Ou.size>0}function Dc(t){return 0===Lr(t).Mu.size}function Cc(t){t.qu=void 0}function Pc(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){return t.Ou.forEach(function(e,n){Nc(t,e)}),[2]})})}function Rc(t,e){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(n){return Cc(t),Sc(t)?(t.Bu.Su(e),xc(t)):t.Bu.set("Unknown"),[2]})})}function Uc(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o;return Object(m.e)(this,function(s){switch(s.label){case 0:if(t.Bu.set("Online"),!(e instanceof qi&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(m.e)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Ou.has(o=i[r])?[4,t.xu.Uu(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Ou.delete(o),t.qu.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Lc(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Vi?t.qu.$e(e):e instanceof Mi?t.qu.je(e):t.qu.qe(e),n.isEqual(Jr.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,ac(t.Cu)];case 8:return i=s.sent(),n.F(i)>=0?[4,function(t,e){var n=t.qu.He(e);return n.re.forEach(function(n,r){if(n.resumeToken.ht()>0){var i=t.Ou.get(r);i&&t.Ou.set(r,i.wt(n.resumeToken,e))}}),n.oe.forEach(function(e){var n=t.Ou.get(e);if(n){t.Ou.set(e,n.wt(fi.lt,n.ft)),kc(t,e);var r=new di(n.target,e,1,n.sequenceNumber);Nc(t,r)}}),t.xu.Qu(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Lc(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Lc(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r=this;return Object(m.e)(this,function(i){switch(i.label){case 0:if(!ku(e))throw e;return t.Mu.add(1),[4,Tc(t)];case 1:return i.sent(),t.Bu.set("Offline"),n||(n=function(){return ac(t.Cu)}),t.di.Mi(function(){return Object(m.b)(r,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Mu.delete(1),[4,Oc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Vc(t,e){return e().catch(function(n){return Lc(t,n,e)})}function Mc(t){return Object(m.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(m.e)(this,function(s){switch(s.label){case 0:e=Lr(t),n=Xc(e),r=e.Fu.length>0?e.Fu[e.Fu.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Dc(t)&&t.Fu.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,hc(e.Cu,r)];case 3:return null===(i=s.sent())?(0===e.Fu.length&&n.Yc(),[3,7]):(r=i.batchId,function(t,e){t.Fu.push(e);var n=Xc(t);n.zc()&&n.fu&&n.du(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Lc(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return qc(e)&&Fc(e),[2]}})})}function qc(t){return Dc(t)&&!Xc(t).Gc()&&t.Fu.length>0}function Fc(t){Xc(t).start()}function zc(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){return Xc(t).Tu(),[2]})})}function Bc(t){return Object(m.b)(this,void 0,void 0,function(){var e,n,r;return Object(m.e)(this,function(i){for(e=Xc(t),n=0,r=t.Fu;n<r.length;n++)e.du(r[n].mutations);return[2]})})}function Gc(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i;return Object(m.e)(this,function(o){switch(o.label){case 0:return r=t.Fu.shift(),i=pu.from(r,e,n),[4,Vc(t,function(){return t.xu.Ku(i)})];case 1:return o.sent(),[4,Mc(t)];case 2:return o.sent(),[2]}})})}function Kc(t,e){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(n){switch(n.label){case 0:return e&&Xc(t).fu?[4,function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r;return Object(m.e)(this,function(i){switch(i.label){case 0:return yi(r=e.code)&&r!==Vr.ABORTED?(n=t.Fu.shift(),Xc(t).Jc(),[4,Vc(t,function(){return t.xu.Wu(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Mc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return qc(t)&&Fc(t),[2]}})})}function Wc(t,e){return Object(m.b)(this,void 0,void 0,function(){var n;return Object(m.e)(this,function(r){switch(r.label){case 0:return n=Lr(t),e?(n.Mu.delete(2),[4,Oc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Mu.add(2),[4,Tc(n)]);case 3:r.sent(),n.Bu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Hc(t){var e=this;return t.ju||(t.ju=function(t,e,n){var r=Lr(t);return r.mu(),new mc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Pc.bind(null,t),nu:Rc.bind(null,t),au:Uc.bind(null,t)}),t.ku.push(function(n){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return n?(t.ju.Jc(),Sc(t)?xc(t):t.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ju.stop()];case 2:e.sent(),Cc(t),e.label=3;case 3:return[2]}})})})),t.ju}function Xc(t){var e=this;return t.Gu||(t.Gu=function(t,e,n){var r=Lr(t);return r.mu(),new wc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:zc.bind(null,t),nu:Kc.bind(null,t),Eu:Bc.bind(null,t),wu:Gc.bind(null,t)}),t.ku.push(function(n){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return n?(t.Gu.Jc(),[4,Mc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Gu.stop()];case 3:e.sent(),t.Fu.length>0&&(Sr("RemoteStore","Stopping write stream with "+t.Fu.length+" pending writes"),t.Fu=[]),e.label=4;case 4:return[2]}})})})),t.Gu}var Qc=function(){this.zu=void 0,this.listeners=[]},Yc=function(){this.queries=new du(function(t){return Ws(t)},Ks),this.onlineState="Unknown",this.Hu=new Set};function Jc(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(m.e)(this,function(c){switch(c.label){case 0:if(n=Lr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Qc),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Ju(r)];case 2:return s.zu=c.sent(),[3,4];case 3:return u=c.sent(),a=Mu(u,"Initialization of query '"+Hs(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Yu(n.onlineState),o.zu&&e.Xu(o.zu)&&eh(n),[2]}})})}function $c(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(m.e)(this,function(u){return n=Lr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Zu(r))]:[2]})})}function Zc(t,e){for(var n=Lr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&eh(n)}function th(t,e,n){var r=Lr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function eh(t){t.Hu.forEach(function(t){t.next()})}var nh=function(){function t(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ri(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},t.prototype.onError=function(t){this.ta.error(t)},t.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},t.prototype.ia=function(t,e){return!t.fromCache||!(this.options.oa&&"Offline"!==e||t.docs.W()&&"Offline"!==e)},t.prototype.sa=function(t){return t.docChanges.length>0||!!(t.ne||this.na&&this.na.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.ra=function(t){t=Ri.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},t}(),rh=function(){function t(){this.ca=new _i(ih.ua),this.aa=new _i(ih.ha)}return t.prototype.W=function(){return this.ca.W()},t.prototype.Do=function(t,e){var n=new ih(t,e);this.ca=this.ca.add(n),this.aa=this.aa.add(n)},t.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},t.prototype.No=function(t,e){this._a(new ih(t,e))},t.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},t.prototype.da=function(t){var e=this,n=new ni(new Zr([])),r=new ih(n,t),i=new ih(n,t+1),o=[];return this.aa.Kt([r,i],function(t){e._a(t),o.push(t.key)}),o},t.prototype.wa=function(){var t=this;this.ca.forEach(function(e){return t._a(e)})},t.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},t.prototype.Ea=function(t){var e=new ni(new Zr([])),n=new ih(e,t),r=new ih(e,t+1),i=xi();return this.aa.Kt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Qr=function(t){var e=new ih(t,0),n=this.ca.jt(e);return null!==n&&t.isEqual(n.key)},t}(),ih=function(){function t(t,e){this.key=t,this.Ta=e}return t.ua=function(t,e){return ni.$(t.key,e.key)||Hr(t.Ta,e.Ta)},t.ha=function(t,e){return Hr(t.Ta,e.Ta)||ni.$(t.key,e.key)},t}();function oh(t,e){return"firestore_clients_"+t+"_"+e}function sh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function uh(t,e){return"firestore_targets_"+t+"_"+e}var ah=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Ia=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Mr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Dr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ch=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Ia=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Mr(r.error.code,r.error.message)),i?new t(e,r.state,o):(Dr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),hh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Ia=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Di(),s=0;i&&s<r.activeTargetIds.length;++s)i=oi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Dr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),fh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Ia=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Dr("SharedClientState","Failed to parse online state: "+e),null)},t}(),lh=function(){function t(){this.activeTargetIds=Di()}return t.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ph=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new bi(Hr),this.lr=!1,this.va=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=oh(this.persistenceKey,this.Pa),this.Sa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pa=this.pa.Tt(this.Pa,new lh),this.Da=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fa=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ya)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(m.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(m.e)(this,function(f){switch(f.label){case 0:return[4,this.ga.Ic()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(oh(this.persistenceKey,r)))&&(o=hh.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)this.Va(c[a]);return this.va=[],this.window.addEventListener("unload",function(){return h.fc()}),this.lr=!0,[2]}})})},t.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},t.prototype.$a=function(){return this.La(this.pa)},t.prototype.Ba=function(t){var e=!1;return this.pa.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.qa=function(t){this.Ua(t,"pending")},t.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},t.prototype.Wa=function(t){var e="not-current";if(this.Ba(t)){var n=this.storage.getItem(uh(this.persistenceKey,t));if(n){var r=ch.Ia(t,n);r&&(e=r.state)}}return this.ja.Aa(t),this.Oa(),e},t.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},t.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},t.prototype.Ha=function(t){this.removeItem(uh(this.persistenceKey,t))},t.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},t.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},t.prototype.Za=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Va=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Sr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ba)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return Object(m.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(m.e)(this,function(u){if(this.lr){if(null!==n.key)if(this.Da.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(n.key)){if(null!==n.newValue&&(r=this.oh(n.key,n.newValue)))return[2,this.uh(r)]}else if(this.Na.test(n.key)){if(null!==n.newValue&&(i=this.ah(n.key,n.newValue)))return[2,this.hh(i)]}else if(n.key===this.xa){if(null!==n.newValue&&(o=this.Ma(n.newValue)))return[2,this.ka(o)]}else if(n.key===this.Sa)(s=function(t){var e=Ou.Ds;if(null!=t)try{var n=JSON.parse(t);Ur("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Ou.Ds&&this.ps(s);else if(n.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),t.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},t.prototype.Ua=function(t,e,n){var r=new ah(this.currentUser,t,e,n),i=sh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ma())},t.prototype.Ka=function(t){var e=sh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){this.storage.setItem(this.xa,JSON.stringify({clientId:this.Pa,onlineState:t}))},t.prototype.Ya=function(t,e,n){var r=uh(this.persistenceKey,t),i=new ch(t,e,n);this.setItem(r,i.ma())},t.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},t.prototype.sh=function(t){var e=this.Da.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return hh.Ia(n,e)},t.prototype.oh=function(t,e){var n=this.Ca.exec(t),r=Number(n[1]);return ah.Ia(new Nr(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ah=function(t,e){var n=this.Na.exec(t),r=Number(n[1]);return ch.Ia(r,e)},t.prototype.Ma=function(t){return fh.Ia(t)},t.prototype.uh=function(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.ga._h(t.batchId,t.state,t.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},t.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},t.prototype.La=function(t){var e=Di();return t.forEach(function(t,n){e=e.Gt(n.activeTargetIds)}),e},t}(),dh=function(){function t(){this.wh=new lh,this.Eh={},this.Pu=null,this.ps=null}return t.prototype.qa=function(t){},t.prototype.Qa=function(t,e,n){},t.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},t.prototype.Ja=function(t,e,n){this.Eh[t]=e},t.prototype.Ga=function(t){this.wh.Ra(t)},t.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Ha=function(t){delete this.Eh[t]},t.prototype.$a=function(){return this.wh.activeTargetIds},t.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new lh,Promise.resolve()},t.prototype.Xa=function(t,e,n){},t.prototype.Za=function(t){},t.prototype.fc=function(){},t.prototype.Ss=function(t){},t.prototype.eh=function(){},t}(),vh=function(t){this.key=t},yh=function(t){this.key=t},gh=function(){function t(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=xi(),this.ee=xi(),this.Ah=Qs(t),this.Rh=new Ci(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.yh:new Pi,i=e?e.Rh:this.Rh,o=e?e.ee:this.ee,s=i,u=!1,a=Ls(this.query)&&i.size===this.query.limit?i.last():null,c=Vs(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt(function(t,e){var h=i.get(t),f=e instanceof Ss?e:null;f&&(f=Xs(n.query,f)?f:null);var l=!!h&&n.ee.has(h.key),p=!!f&&(f.an||n.ee.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Vh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Ah(f,a)>0||c&&n.Ah(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),Ls(this.query)||Vs(this.query))for(;s.size>this.query.limit;){var h=Ls(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:s,yh:r,ph:u,ee:o}},t.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var o=t.yh.Zt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)}),this.bh(n);var s=e?this.Sh():[],u=0===this.mh.size&&this.le?1:0,a=u!==this.Ih;return this.Ih=u,0!==o.length||a?{snapshot:new Ri(this.query,t.Rh,i,o,t.ee,0===u,a,!1),Dh:s}:{Dh:s}},t.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Pi,ee:this.ee,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},t.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},t.prototype.Sh=function(){var t=this;if(!this.le)return[];var e=this.mh;this.mh=xi(),this.Rh.forEach(function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))});var n=[];return e.forEach(function(e){t.mh.has(e)||n.push(new yh(e))}),this.mh.forEach(function(t){e.has(t)||n.push(new vh(t))}),n},t.prototype.Nh=function(t){this.Th=t.Bc,this.mh=xi();var e=this.gh(t.documents);return this.Zn(e,!0)},t.prototype.xh=function(){return Ri.ie(this.query,this.Rh,this.ee,0===this.Ih)},t}(),bh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},mh=function(t){this.key=t,this.Fh=!1},wh=function(){function t(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new du(function(t){return Ws(t)},Ks),this.qh=new Map,this.Uh=[],this.Qh=new bi(ni.$),this.Kh=new Map,this.Wh=new rh,this.jh={},this.Gh=new Map,this.zh=Ka._o(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function _h(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:return n=Yh(t),(i=n.Bh.get(e))?(n.kh.Wa(i.targetId),r=i.view.xh(),[3,4]):[3,1];case 1:return[4,fc(n.Cu,Bs(e))];case 2:return o=u.sent(),s=n.kh.Wa(o.targetId),[4,Ih(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.Jh&&jc(n.Oh,o),u.label=4;case 4:return[2,r]}})})}function Ih(t,e,n,r){return Object(m.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(m.e)(this,function(h){switch(h.label){case 0:return t.Yh=function(e,n,r){return function(t,e,n,r){return Object(m.b)(this,void 0,void 0,function(){var i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:return(i=e.view.gh(n)).ph?[4,pc(t.Cu,e.query,!1).then(function(t){return e.view.gh(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.re.get(e.targetId),s=e.view.Zn(i,t.Jh,o),[2,(Rh(t,e.targetId,s.Dh),s.snapshot)]}})})}(t,e,n,r)},[4,pc(t.Cu,e,!0)];case 1:return i=h.sent(),o=new gh(e,i.Bc),s=o.gh(i.documents),u=Li.he(n,r&&"Offline"!==t.onlineState),a=o.Zn(s,t.Jh,u),Rh(t,n,a.Dh),c=new bh(e,n,o),[2,(t.Bh.set(e,c),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),a.snapshot)]}})})}function Eh(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i;return Object(m.e)(this,function(o){switch(o.label){case 0:return n=Lr(t),r=n.Bh.get(e),(i=n.qh.get(r.targetId)).length>1?[2,(n.qh.set(r.targetId,i.filter(function(t){return!Ks(t,e)})),void n.Bh.delete(e))]:n.Jh?(n.kh.Ga(r.targetId),n.kh.Ba(r.targetId)?[3,2]:[4,lc(n.Cu,r.targetId,!1).then(function(){n.kh.Ha(r.targetId),Ac(n.Oh,r.targetId),Ch(n,r.targetId)}).catch(gc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Ch(n,r.targetId),[4,lc(n.Cu,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Oh(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:r=Jh(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Lr(t),i=Yr.now(),o=e.reduce(function(t,e){return t.add(e.key)},xi());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Oc._s(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=ys(c,n.get(c.key));null!=h&&s.push(new ws(c.key,h,ks(h.proto.mapValue),fs.exists(!0)))}return r.rs.Sr(t,i,s,e)})}).then(function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}})}(r.Cu,e)];case 2:return i=u.sent(),r.kh.qa(i.batchId),function(t,e,n){var r=t.jh[t.currentUser.h()];r||(r=new bi(Hr)),r=r.Tt(e,n),t.jh[t.currentUser.h()]=r}(r,i.batchId,n),[4,Vh(r,i.Qn)];case 3:return u.sent(),[4,Mc(r.Oh)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Mu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Th(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r;return Object(m.e)(this,function(i){switch(i.label){case 0:n=Lr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,cc(n.Cu,e)];case 2:return r=i.sent(),e.re.forEach(function(t,e){var r=n.Kh.get(e);r&&(Ur(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.Fh=!0:t.fe.size>0?Ur(r.Fh):t.de.size>0&&(Ur(r.Fh),r.Fh=!1))}),[4,Vh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,gc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function jh(t,e,n){var r=Lr(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach(function(t,n){var r=n.view.Yu(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Lr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Yu(e)&&(r=!0)}),r&&eh(n)}(r.Mh,e),i.length&&r.Lh.au(i),r.onlineState=e,r.Jh&&r.kh.Za(e)}}function Ah(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(m.e)(this,function(c){switch(c.label){case 0:return(r=Lr(t)).kh.Ja(e,"rejected",n),i=r.Kh.get(e),(o=i&&i.key)?(s=(s=new bi(ni.$)).Tt(o,new Ds(o,Jr.min())),u=xi().add(o),a=new Ui(Jr.min(),new Map,new _i(Hr),s,u),[4,Th(r,a)]):[3,2];case 1:return c.sent(),r.Qh=r.Qh.remove(o),r.Kh.delete(e),Lh(r),[3,4];case 2:return[4,lc(r.Cu,e,!1).then(function(){return Ch(r,e,n)}).catch(gc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Nh(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i;return Object(m.e)(this,function(o){switch(o.label){case 0:n=Lr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,uc(n.Cu,e)];case 2:return i=o.sent(),Dh(n,r,null),Sh(n,r),n.kh.Qa(r,"acknowledged"),[4,Vh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,gc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function kh(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i;return Object(m.e)(this,function(o){switch(o.label){case 0:r=Lr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Lr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.rs.Cr(t,e).next(function(e){return Ur(null!==e),r=e.keys(),n.rs.$r(t,e)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}(r.Cu,e)];case 2:return i=o.sent(),Dh(r,e,n),Sh(r,e),r.kh.Qa(e,"rejected",n),[4,Vh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,gc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function xh(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:Dc((n=Lr(t)).Oh)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Lr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})}(n.Cu)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Gh.get(r)||[]).push(e),n.Gh.set(r,i),[3,4]);case 3:return o=u.sent(),s=Mu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Sh(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function Dh(t,e,n){var r=Lr(t),i=r.jh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i}}function Ch(t,e,n){void 0===n&&(n=null),t.kh.Ga(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.da(e).forEach(function(e){t.Wh.Qr(e)||Ph(t,e)})}function Ph(t,e){var n=t.Qh.get(e);null!==n&&(Ac(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),Lh(t))}function Rh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof vh?(t.Wh.Do(o.key,e),Uh(t,o)):o instanceof yh?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||Ph(t,o.key)):Rr()}}function Uh(t,e){var n=e.key;t.Qh.get(n)||(Sr("SyncEngine","New document in limbo: "+n),t.Uh.push(n),Lh(t))}function Lh(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new mh(e)),t.Qh=t.Qh.Tt(e,n),jc(t.Oh,new di(Bs(Us(e.path)),n,2,Ou.Ds))}}function Vh(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:return r=Lr(t),i=[],o=[],s=[],r.Bh.W()?[3,3]:(r.Bh.forEach(function(t,u){s.push(r.Yh(u,e,n).then(function(t){if(t){r.Jh&&r.kh.Ja(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Eu.Vs(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.Lh.au(i),[4,function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(m.e)(this,function(h){switch(h.label){case 0:n=Lr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return vu.forEach(e,function(e){return vu.forEach(e.gs,function(r){return n.persistence.Vr.Do(t,e.targetId,r)}).next(function(){return vu.forEach(e.ys,function(r){return n.persistence.Vr.No(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!ku(r=h.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.Cc.get(u),c=a.Et(a.ft),n.Cc=n.Cc.Tt(u,c));return[2]}})})}(r.Cu,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function Mh(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r;return Object(m.e)(this,function(i){switch(i.label){case 0:return(n=Lr(t)).currentUser.isEqual(e)?[3,3]:(Sr("SyncEngine","User change. New user:",e.h()),[4,sc(n.Cu,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Gh.forEach(function(t){t.forEach(function(t){t.reject(new Mr(Vr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Gh.clear()}(n),n.kh.Xa(e,r.$c,r.Lc),[4,Vh(n,r.kc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function qh(t,e){var n=Lr(t),r=n.Kh.get(e);if(r&&r.Fh)return xi().add(r.key);var i=xi(),o=n.qh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Bh.get(u[s]);i=i.Gt(a.view.Ph)}return i}function Fh(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i;return Object(m.e)(this,function(o){switch(o.label){case 0:return[4,pc((n=Lr(t)).Cu,e.query,!0)];case 1:return r=o.sent(),i=e.view.Nh(r),[2,(n.Jh&&Rh(n,e.targetId,i.Dh),i)]}})})}function zh(t){return Object(m.b)(this,void 0,void 0,function(){var e;return Object(m.e)(this,function(n){return[2,vc((e=Lr(t)).Cu).then(function(t){return Vh(e,t)})]})})}function Bh(t,e,n,r){return Object(m.b)(this,void 0,void 0,function(){var i,o;return Object(m.e)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Lr(t),r=Lr(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Nr(t,e).next(function(e){return e?n.Oc._s(t,e):vu.resolve(null)})})}((i=Lr(t)).Cu,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Mc(i.Oh)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Dh(i,e,r||null),Sh(i,e),function(t,e){Lr(Lr(t).rs).Br(e)}(i.Cu,e)):Rr(),s.label=4;case 4:return[4,Vh(i,o)];case 5:return s.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function Gh(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(m.e)(this,function(c){switch(c.label){case 0:return Yh(n=Lr(t)),Jh(n),!0!==e||!0===n.Hh?[3,3]:(r=n.kh.$a(),[4,Kh(n,r.H())]);case 1:return i=c.sent(),n.Hh=!0,[4,Wc(n.Oh,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)jc(n.Oh,s[o]);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(u=[],a=Promise.resolve(),n.qh.forEach(function(t,e){n.kh.za(e)?u.push(e):a=a.then(function(){return Ch(n,e),lc(n.Cu,e,!0)}),Ac(n.Oh,e)}),[4,a]);case 4:return c.sent(),[4,Kh(n,u)];case 5:return c.sent(),function(t){var e=Lr(t);e.Kh.forEach(function(t,n){Ac(e.Oh,n)}),e.Wh.wa(),e.Kh=new Map,e.Qh=new bi(ni.$)}(n),n.Hh=!1,[4,Wc(n.Oh,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Kh(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(m.e)(this,function(v){switch(v.label){case 0:n=Lr(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.qh.get(u=s[o]))&&0!==c.length?[4,fc(n.Cu,Bs(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Bh.get(f[h]),[4,Fh(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,dc(n.Cu,u)];case 8:return d=v.sent(),[4,fc(n.Cu,d)];case 9:return a=v.sent(),[4,Ih(n,Wh(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Lh.au(i),r)]}})})}function Wh(t){return Rs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Hh(t){var e=Lr(t);return Lr(Lr(e.Cu).persistence).Ic()}function Xh(t,e,n,r){return Object(m.b)(this,void 0,void 0,function(){var i,o,s;return Object(m.e)(this,function(u){switch(u.label){case 0:return(i=Lr(t)).Hh?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,vc(i.Cu)];case 3:return o=u.sent(),s=Ui.ae(e,"current"===n),[4,Vh(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,lc(i.Cu,e,!0)];case 6:return u.sent(),Ch(i,e,r),[3,8];case 7:Rr(),u.label=8;case 8:return[2]}})})}function Qh(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(m.e)(this,function(l){switch(l.label){case 0:if(!(r=Yh(t)).Hh)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.qh.has(s=o[i])?(Sr("SyncEngine","Adding an already active target "+s),[3,5]):[4,dc(r.Cu,s)]:[3,6];case 2:return u=l.sent(),[4,fc(r.Cu,u)];case 3:return a=l.sent(),[4,Ih(r,Wh(u),a.targetId,!1)];case 4:l.sent(),jc(r.Oh,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(m.e)(this,function(e){switch(e.label){case 0:return r.qh.has(t)?[4,lc(r.Cu,t,!1).then(function(){Ac(r.Oh,t),Ch(r,t)}).catch(gc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Yh(t){var e=Lr(t);return e.Oh.xu.Qu=Th.bind(null,e),e.Oh.xu.Xe=qh.bind(null,e),e.Oh.xu.Uu=Ah.bind(null,e),e.Lh.au=Zc.bind(null,e.Mh),e.Lh.Xh=th.bind(null,e.Mh),e}function Jh(t){var e=Lr(t);return e.Oh.xu.Ku=Nh.bind(null,e),e.Oh.xu.Wu=kh.bind(null,e),e}var $h=function(){function t(){}return t.prototype.Mc=function(t){this.Zh=t},t.prototype.ws=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(Jr.min())?this.tl(t,e):this.Zh._s(t,r).next(function(o){var s=i.el(e,o);return(Ls(e)||Vs(e))&&i.ph(e.limitType,s,r,n)?i.tl(t,e):(xr()<=_.a.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Hs(e)),i.Zh.ws(t,e,n).next(function(t){return s.forEach(function(e){t=t.Tt(e.key,e)}),t}))})},t.prototype.el=function(t,e){var n=new _i(Qs(t));return e.forEach(function(e,r){r instanceof Ss&&Xs(t,r)&&(n=n.add(r))}),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.tl=function(t,e){return xr()<=_.a.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",Hs(e)),this.Zh.ws(t,e,Jr.min())},t}(),Zh=function(){function t(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new _i(ih.ua)}return t.prototype.br=function(t){return vu.resolve(0===this.rs.length)},t.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++;var o=new lu(i,e,n,r);this.rs.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.sl=this.sl.add(new ih(a.key,i)),this.os.Dr(t,a.key.path.q())}return vu.resolve(o)},t.prototype.Cr=function(t,e){return vu.resolve(this.il(e))},t.prototype.Fr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return vu.resolve(this.rs.length>r?this.rs[r]:null)},t.prototype.Or=function(){return vu.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.Mr=function(t){return vu.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new ih(e,0),i=new ih(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],function(t){var e=n.il(t.Ta);o.push(e)}),vu.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new _i(Hr);return e.forEach(function(t){var e=new ih(t,0),i=new ih(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],function(t){r=r.add(t.Ta)})}),vu.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;ni.ot(i)||(i=i.child(""));var o=new ih(new ni(i),0),s=new _i(Hr);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(s=s.add(t.Ta)),!0)},o),vu.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.il(t);null!==r&&n.push(r)}),n},t.prototype.$r=function(t,e){var n=this;Ur(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return vu.forEach(e.mutations,function(i){var o=new ih(i.key,e.batchId);return r=r.delete(o),n.Vr.qr(t,i.key)}).next(function(){n.sl=r})},t.prototype.Br=function(t){},t.prototype.Qr=function(t,e){var n=new ih(e,0),r=this.sl.jt(n);return vu.resolve(e.isEqual(r&&r.key))},t.prototype.Ur=function(t){return vu.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),tf=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new bi(ni.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:s,readTime:n}),this.size+=s-o,this.os.Dr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return vu.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ti();return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),vu.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=Ai(),i=new ni(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.value,a=u.zn,c=u.readTime;if(!e.path.j(s.key.path))break;c.F(n)<=0||a instanceof Ss&&Xs(e,a)&&(r=r.Tt(a.key,a))}return vu.resolve(r)},t.prototype.al=function(t,e){return vu.forEach(this.docs,function(t){return e(t)})},t.prototype.Xr=function(t){return new ef(this)},t.prototype.eo=function(t){return vu.resolve(this.size)},t}(),ef=function(t){function e(e){var n=this;return(n=t.call(this)||this).no=e,n}return Object(m.d)(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach(function(r,i){i&&i.zn?n.push(e.no.jn(t,i.zn,e.Wn(r))):e.no.Hn(r)}),vu.qn(n)},e.prototype.Yn=function(t,e){return this.no.Jn(t,e)},e.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},e}(yu),nf=function(){function t(t){this.persistence=t,this.hl=new du(function(t){return ai(t)},ci),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this.ll=0,this._l=new rh,this.targetCount=0,this.fl=Ka.lo()}return t.prototype.Ue=function(t,e){return this.hl.forEach(function(t,n){return e(n)}),vu.resolve()},t.prototype.To=function(t){return vu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Io=function(t){return vu.resolve(this.ll)},t.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),vu.resolve(this.highestTargetId)},t.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),vu.resolve()},t.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new Ka(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,vu.resolve()},t.prototype.yo=function(t,e){return this.Ro(e),vu.resolve()},t.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),this.targetCount-=1,vu.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.hl.delete(s),o.push(r.po(t,u.targetId)),i++)}),vu.qn(o).next(function(){return i})},t.prototype.vo=function(t){return vu.resolve(this.targetCount)},t.prototype.bo=function(t,e){var n=this.hl.get(e)||null;return vu.resolve(n)},t.prototype.So=function(t,e,n){return this._l.la(e,n),vu.resolve()},t.prototype.Co=function(t,e,n){this._l.fa(e,n);var r=this.persistence.Vr,i=[];return r&&e.forEach(function(e){i.push(r.qr(t,e))}),vu.qn(i)},t.prototype.po=function(t,e){return this._l.da(e),vu.resolve()},t.prototype.xo=function(t,e){var n=this._l.Ea(e);return vu.resolve(n)},t.prototype.Qr=function(t,e){return vu.resolve(this._l.Qr(e))},t}(),rf=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ro=function(t,e){return vu.resolve(this.dl.get(e))},t.prototype.oo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:Oo(n.createTime)}),vu.resolve()},t.prototype.co=function(t,e){return vu.resolve(this.wl.get(e))},t.prototype.uo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:sa(n.bundledQuery),readTime:Oo(n.readTime)}),vu.resolve()},t}(),of=function(){function t(t,e){var n=this;this.El={},this.ko=new Ou(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new nf(this),this.os=new ma,this.ss=function(t,e){return new tf(t,function(t){return n.Vr.Tl(t)})}(this.os),this.serializer=new Yu(e),this.Go=new rf(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.tc=function(){},t.prototype.ec=function(){},t.prototype.Pc=function(){return this.os},t.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Zh(this.os,this.Vr),this.El[t.h()]=e),e},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new sf(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},t.prototype.Al=function(t,e){return vu.Un(Object.values(this.El).map(function(n){return function(){return n.Qr(t,e)}}))},t}(),sf=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fo=e,n}return Object(m.d)(e,t),e}(_u),uf=function(){function t(t){this.persistence=t,this.Rl=new rh,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Rr()},enumerable:!1,configurable:!0}),t.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),vu.resolve()},t.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),vu.resolve()},t.prototype.qr=function(t,e){return this.yl.add(e.toString()),vu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Rc().Xr();return vu.forEach(this.yl,function(r){var i=ni.st(r);return e.Vl(t,i).next(function(t){t||n.Hn(i)})}).next(function(){return e.Pl=null,n.apply(t)})},t.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return vu.Un([function(){return vu.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),af=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.cu=function(t){this.bl=t},t.prototype.nu=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),cf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},hf=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(m.d)(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise(function(i,o){var s=new Or;s.listenOnce(_r.COMPLETE,function(){try{switch(s.getLastErrorCode()){case wr.NO_ERROR:var e=s.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case wr.TIMEOUT:Sr("Connection",'RPC "'+t+'" timed out'),o(new Mr(Vr.DEADLINE_EXCEEDED,"Request time out"));break;case wr.HTTP_ERROR:var n=s.getStatus();if(Sr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(Vr).indexOf(e)>=0?e:Vr.UNKNOWN}(r.status);o(new Mr(u,r.message))}else o(new Mr(Vr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Mr(Vr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Sr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.uu=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new vr,i=ge(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(o.initMessageHeaders,e),Object(I.p)()||Object(I.r)()||Object(I.m)()||Object(I.n)()||Object(I.s)()||Object(I.l)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Sr("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new af({pl:function(t){c?Sr("Connection","Not sending because WebChannel is closed:",t):(a||(Sr("Connection","Opening WebChannel transport."),u.open(),a=!0),Sr("Connection","WebChannel sending:",t),u.send(t))},vl:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,Er.EventType.OPEN,function(){c||Sr("Connection","WebChannel transport opened.")}),f(u,Er.EventType.CLOSE,function(){c||(c=!0,Sr("Connection","WebChannel transport closed"),h.Nl())}),f(u,Er.EventType.ERROR,function(t){c||(c=!0,Cr("Connection","WebChannel transport errored:",t),h.Nl(new Mr(Vr.UNAVAILABLE,"The operation could not be completed")))}),f(u,Er.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Ur(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Sr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=li[t];if(void 0!==e)return gi(e)}(i),s=r.message;void 0===o&&(o=Vr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Nl(new Mr(o,s)),u.close()}else Sr("Connection","WebChannel received:",n),h.xl(n)}}),f(i,Ir.STAT_EVENT,function(t){10===t.stat?Sr("Connection","Detected buffering proxy"):11===t.stat&&Sr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Cl()},0),h},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.Au=function(t,e,n,r){var i=this.kl(t,e);Sr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(e){throw Cr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+cf[t]},t}()),ff=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Lu=function(t){this.Kl.push(t)},t.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),lf=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype.fc=function(){},t}(),pf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return this.serializer=bu(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Cu=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return oc(this.persistence,new $h,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new of(uf.gl,this.serializer)},t.prototype.jl=function(t){return new dh},t.prototype.terminate=function(){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},t}(),df=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(m.d)(e,t),e.prototype.initialize=function(e){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,yc(this.Cu)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Jh(this.Xl.ga)];case 4:return n.sent(),[4,Mc(this.Xl.Oh)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return oc(this.persistence,new $h,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new Gu(this.persistence.Vr.cr,t.di)},e.prototype.Gl=function(t){var e=rc(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Bu.er(this.cacheSizeBytes):Bu.ir;return new $a(this.synchronizeTabs,e,t.clientId,n,t.di,Ru(),Uu(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new dh},e}(pf),vf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(m.d)(e,t),e.prototype.initialize=function(e){return Object(m.b)(this,void 0,void 0,function(){var n,r=this;return Object(m.e)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.ga,this.kh instanceof ph?(this.kh.ga={_h:Bh.bind(null,n),fh:Xh.bind(null,n),dh:Qh.bind(null,n),Ic:Hh.bind(null,n),lh:zh.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Zo(function(t){return Object(m.b)(r,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,Gh(this.Xl.ga,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Cu):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=Ru();if(!ph.Gs(e))throw new Mr(Vr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=rc(t.Fl.t,t.Fl.persistenceKey);return new ph(e,t.di,n,t.clientId,t.Yl)},e}(df),yf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n=this;return Object(m.e)(this,function(r){switch(r.label){case 0:return this.Cu?[3,2]:(this.Cu=t.Cu,this.kh=t.kh,this.Nu=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.ga=this.n_(e,!t.synchronizeTabs),this.kh.Pu=function(t){return jh(n.ga,t,1)},this.Oh.xu.s_=Mh.bind(null,this.ga),[4,Wc(this.Oh,this.ga.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new Yc},t.prototype.Zl=function(t){var e=bu(t.Fl.t),n=new hf(t.Fl);return function(t,e,n){return new _c(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Cu,n=this.Nu,r=t.di,i=function(t){return jh(s.ga,t,0)},o=ff.Gs()?new ff:new lf,new Ec(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new wh(t,e,n,r,i,o);return s&&(u.Hh=!0),u}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return Object(m.b)(this,void 0,void 0,function(){var e;return Object(m.e)(this,function(n){switch(n.label){case 0:return e=Lr(t),Sr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,Tc(e)];case 1:return n.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},t}(),gf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),bf=function(t){this.o_=t};function mf(t,e,n){if(!n)throw new Mr(Vr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function wf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function _f(t,e,n,r){if(!0===e&&!0===r)throw new Mr(Vr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function If(t){if(!ni.ot(t))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ef(t){if(ni.ot(t))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Of(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Rr()}function Tf(t,e){if(t instanceof bf&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Mr(Vr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Of(t);throw new Mr(Vr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function jf(t,e){if(e<=0)throw new Mr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Af=function(t){this.c_=t},Nf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.u_=function(t){if(2!==t.a_)throw t.h_(1===t.a_?this.c_+"() can only appear at the top level of your update data":this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Af);function kf(t,e,n){return new Dl({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.u_=function(t){return new cs(t.path,new ts)},e.prototype.isEqual=function(t){return t instanceof e},e}(Af),Sf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(m.d)(e,t),e.prototype.u_=function(t){var e=kf(this,t,!0),n=this.f_.map(function(t){return Vl(t,e)}),r=new es(n);return new cs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Af),Df=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(m.d)(e,t),e.prototype.u_=function(t){var e=kf(this,t,!0),n=this.f_.map(function(t){return Vl(t,e)}),r=new rs(n);return new cs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Af),Cf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return Object(m.d)(e,t),e.prototype.u_=function(t){var e=new os(t.serializer,wo(t.serializer,this.d_));return new cs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Af),Pf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Mr(Vr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Mr(Vr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},t.prototype.C=function(t){return Hr(this.w_,t.w_)||Hr(this.E_,t.E_)},t}(),Rf=function(){function t(t){this.T_=t}return t.fromBase64String=function(e){try{return new t(fi.fromBase64String(e))}catch(e){throw new Mr(Vr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(fi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.T_.toBase64()},t.prototype.toUint8Array=function(){return this.T_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},t}(),Uf=new Map,Lf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Mr(Vr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Mr(Vr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,_f("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Vf=function(){function t(t,e){this.I_="(lite)",this.m_=new Lf({}),this.A_=!1,t instanceof Ar?(this.R_=t,this.P_=new Fr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Mr(Vr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ar(t.options.projectId)}(t),this.P_=new zr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.g_)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),t.prototype.v_=function(t){if(this.A_)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Lf(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new Fr;switch(t.type){case"gapi":var e=t.client;return Ur(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Gr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Mr(Vr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.b_=function(){return this.m_},t.prototype.S_=function(){return this.A_=!0,this.m_},t.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},t.prototype.D_=function(){return function(t){var e=Uf.get(t);e&&(Sr("ComponentProvider","Removing Datastore"),Uf.delete(t),e.terminate())}(this),Promise.resolve()},t}();function Mf(){if("undefined"==typeof Uint8Array)throw new Mr(Vr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qf(){if("undefined"==typeof atob)throw new Mr(Vr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ff=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.fromBase64String=function(t){return qf(),new e(Rf.fromBase64String(t))},e.fromUint8Array=function(t){return Mf(),new e(Rf.fromUint8Array(t))},e.prototype.toBase64=function(){return qf(),this.o_.toBase64()},e.prototype.toUint8Array=function(){return Mf(),this.o_.toUint8Array()},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(bf),zf=function(){function t(){}return t.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),$i(t)){case 0:return null;case 1:return t.booleanValue;case 2:return so(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(uo(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Rr()}},t.prototype.L_=function(t,e){var n=this,r={};return Wi(t.fields||{},function(t,i){r[t]=n.C_(i,e)}),r},t.prototype.M_=function(t){return new Pf(so(t.latitude),so(t.longitude))},t.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},t.prototype.x_=function(t,e){switch(e){case"previous":var n=Qi(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(Yi(t));default:return null}},t.prototype.N_=function(t){var e=oo(t);return new Yr(e.seconds,e.nanos)},t.prototype.B_=function(t,e){var n=Zr.Y(t);Ur(Qo(n));var r=new Ar(n.get(1),n.get(3)),i=new ni(n.B(5));return r.isEqual(e)||Dr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Bf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(m.d)(e,t),e.prototype.F_=function(t){return new Ff(new Rf(t))},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return yp.q_(e,this.firestore,null)},e}(zf),Gf=function(){function t(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ul(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.W_},t.prototype.data=function(){if(this.W_){if(this.j_){var t=new Kf(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},t.prototype.get=function(t){if(this.W_){var e=this.W_.data().field(Wf("DocumentSnapshot.get",t));if(null!==e)return this.Q_.C_(e)}},t}(),Kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Gf);function Wf(t,e){return"string"==typeof e?Gl(t,e):e instanceof bf?e.o_.G_:e.G_}var Hf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new ei(t)}return t.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},t}(),Xf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).z_=new Vu,r.I_="name"in e?e.name:"[DEFAULT]",r}return Object(m.d)(e,t),e.prototype.D_=function(){return this.H_||pp(this),this.H_.terminate()},e}(Vf);function Qf(t,e,n){var r=this,i=new gu;return t.di.enqueue(function(){return Object(m.b)(r,void 0,void 0,function(){var r;return Object(m.e)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Yl(t,n)];case 1:return o.sent(),[4,Jl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Vr.FAILED_PRECONDITION||t.code===Vr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Yf(t){if(t.y_||t.V_)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Jf=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).U_=e,u.J_=e,u.metadata=o,u}return Object(m.d)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new $f(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){var n=this.W_.data().field(Wf("DocumentSnapshot.get",t));if(null!==n)return this.Q_.C_(n,e.serverTimestamps)}},e}(Gf),$f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Jf),Zf=function(){function t(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new wp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Y_.docs.forEach(function(r){t.call(e,new $f(n.U_,n.Q_,r.key,r,new wp(n.Y_.ee.has(r.key),n.Y_.fromCache),n.query.j_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.Y_.se)throw new Mr(Vr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===e||(this.X_=function(t,e){if(t.Y_.te.W()){var n=0;return t.Y_.docChanges.map(function(e){return{type:"added",doc:new $f(t.U_,t.Q_,e.doc.key,e.doc,new wp(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),oldIndex:-1,newIndex:n++}})}var r=t.Y_.te;return t.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new $f(t.U_,t.Q_,e.doc.key,e.doc,new wp(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:tl(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.Z_=e),this.X_},t}();function tl(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}function el(t,e){return t instanceof Jf&&e instanceof Jf?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Zf&&e instanceof Zf&&t.U_===e.U_&&jl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var nl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(m.d)(e,t),e.prototype.F_=function(t){return new Rf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new ul(this.firestore,null,e)},e}(zf);function rl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Tf(t.firestore,Xf),s=Al(o);return e instanceof bf&&(e=e.o_),ol(o,("string"==typeof e||e instanceof Hf?Ul(s,"updateDoc",t.K_,e,n,r):Rl(s,"updateDoc",t.K_,e)).ef(t.K_,fs.exists(!0)))}function il(t){for(var e,n,r,i=this,o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];var u={includeMetadataChanges:!1},a=0;"object"!=typeof o[a]||mu(o[a])||(u=o[a],a++);var c,h,f,l={includeMetadataChanges:u.includeMetadataChanges};if(mu(o[a])){var p=o[a];o[a]=null===(e=p.next)||void 0===e?void 0:e.bind(p),o[a+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[a+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof ul)h=Tf(t.firestore,Xf),f=Us(t.K_.path),c={next:function(e){o[a]&&o[a](sl(h,t,e))},error:o[a+1],complete:o[a+2]};else{h=Tf(t.firestore,Xf),f=t.tf;var d=new nl(h);c={next:function(e){o[a]&&o[a](new Zf(h,d,t,e))},error:o[a+1],complete:o[a+2]},wl(t.tf)}var v=lp(h),y=new gf(c),g=new nh(f,y,l);return h.z_.Ri(function(){return Object(m.b)(i,void 0,void 0,function(){var t;return Object(m.e)(this,function(e){switch(e.label){case 0:return t=Jc,[4,ip(v)];case 1:return[2,t.apply(void 0,[e.sent(),g])]}})})}),function(){y.r_(),h.z_.Ri(function(){return Object(m.b)(i,void 0,void 0,function(){var t;return Object(m.e)(this,function(e){switch(e.label){case 0:return t=$c,[4,ip(v)];case 1:return[2,t.apply(void 0,[e.sent(),g])]}})})})}}function ol(t,e){return function(t,e){var n=this,r=new gu;return t.di.Ri(function(){return Object(m.b)(n,void 0,void 0,function(){var n;return Object(m.e)(this,function(i){switch(i.label){case 0:return n=Oh,[4,rp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(lp(t),e)}function sl(t,e,n){var r=n.docs.get(e.K_),i=new nl(t);return new Jf(t,i,e.K_,r,new wp(n.hasPendingWrites,n.fromCache),e.j_)}var ul=function(){function t(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new _l(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.K_)},t}(),al=function(){function t(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.tf)},t}(),cl=function(){};function hl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.sf(t)}return t}var fl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).rf=e,i.cf=n,i.uf=r,i.type="where",i}return Object(m.d)(e,t),e.prototype.sf=function(t){var e=Al(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){bl(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(gl(r,t,h[c]));u={arrayValue:{values:a}}}else u=gl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||bl(s,o),u=Ll(n,"where",s,"in"===o||"not-in"===o);var f=Ys.create(i,o,u);return function(t,e){if(e.An()){var n=qs(t);if(null!==n&&!n.isEqual(e.field))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ms(t);null!==r&&ml(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Mr(Vr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.tf,0,e,t.firestore.R_,this.rf,this.cf,this.uf);return new al(t.firestore,t.j_,function(t,e){var n=t.filters.concat([e]);return new Ps(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,n))},e}(cl),ll=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).rf=e,r.af=n,r.type="orderBy",r}return Object(m.d)(e,t),e.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new cu(e,n);return function(t,e){if(null===Ms(t)){var n=qs(t);null!==n&&ml(0,n,e.field)}}(t,r),r}(t.tf,this.rf,this.af);return new al(t.firestore,t.j_,function(t,e){var n=t.Tn.concat([e]);return new Ps(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,e))},e}(cl),pl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.hf=n,i.lf=r,i}return Object(m.d)(e,t),e.prototype.sf=function(t){return new al(t.firestore,t.j_,Gs(t.tf,this.hf,this.lf))},e}(cl),dl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(m.d)(e,t),e.prototype.sf=function(t){var e=yl(t,this.type,this._f,this.ff);return new al(t.firestore,t.j_,function(t,e){return new Ps(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.tf,e))},e}(cl),vl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(m.d)(e,t),e.prototype.sf=function(t){var e=yl(t,this.type,this._f,this.ff);return new al(t.firestore,t.j_,function(t,e){return new Ps(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.tf,e))},e}(cl);function yl(t,e,n,r){if(n[0]instanceof bf&&(n[0]=n[0].o_),n[0]instanceof Gf)return function(t,e,n,r,i){if(!r)throw new Mr(Vr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=zs(t);s<u.length;s++){var a=u[s];if(a.field.tt())o.push(ao(e,r.key));else{var c=r.field(a.field);if(Xi(c))throw new Mr(Vr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ou(o,i)}(t.tf,t.firestore.R_,e,n[0].W_,r);var i=Al(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new Mr(Vr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Fs(t)&&-1!==c.indexOf("/"))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Zr.Y(c));if(!ni.ot(h))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ni(h);u.push(ao(e,f))}else{var l=Ll(n,r,c);u.push(l)}}return new ou(u,o)}(t.tf,t.firestore.R_,i,e,n,r)}function gl(t,e,n){if(n instanceof bf&&(n=n.o_),"string"==typeof n){if(""===n)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fs(e)&&-1!==n.indexOf("/"))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Zr.Y(n));if(!ni.ot(r))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ao(t,new ni(r))}if(n instanceof ul)return ao(t,n.K_);throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Of(n)+".")}function bl(t,e){if(!Array.isArray(t)||0===t.length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ml(t,e,n){if(!n.isEqual(e))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function wl(t){if(Vs(t)&&0===t.Tn.length)throw new Mr(Vr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _l=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Us(r))||this).firestore=e,i.nf=r,i.type="collection",i}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new ul(this.firestore,null,new ni(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.nf)},e}(al);function Il(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(mf("collection","path",e),t instanceof Vf){var i=Zr.Y.apply(Zr,Object(m.j)([e],n));return Ef(i),new _l(t,null,i)}if(!(t instanceof ul||t instanceof _l))throw new Mr(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=Zr.Y.apply(Zr,Object(m.j)([t.path],n)).child(Zr.Y(e));return Ef(o),new _l(t.firestore,null,o)}function El(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Wr.D()),mf("doc","path",e),t instanceof Vf){var i=Zr.Y.apply(Zr,Object(m.j)([e],n));return If(i),new ul(t,null,new ni(i))}if(!(t instanceof ul||t instanceof _l))throw new Mr(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t.nf.child(Zr.Y.apply(Zr,Object(m.j)([e],n)));return If(o),new ul(t.firestore,t instanceof _l?t.j_:null,new ni(o))}var Ol=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(m.d)(e,t),e.prototype.F_=function(t){return new Rf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new ul(this.firestore,null,e)},e}(zf);function Tl(t,e){return(t instanceof ul||t instanceof _l)&&(e instanceof ul||e instanceof _l)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function jl(t,e){return t instanceof al&&e instanceof al&&t.firestore===e.firestore&&Ks(t.tf,e.tf)&&t.j_===e.j_}function Al(t){var e=t.S_(),n=bu(t.R_);return new Cl(t.R_,!!e.ignoreUndefinedProperties,n)}var Nl=/^__.*__$/,kl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[];return n.push(null!==this.en?new ws(t,this.data,this.en,e):new ms(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Is(t,this.fieldTransforms)),n},t}(),xl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[new ws(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new Is(t,this.fieldTransforms)),n},t}();function Sl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Rr()}}var Dl=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.wf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.Ef=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.Tf(t),r},t.prototype.If=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.df(),r},t.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},t.prototype.h_=function(t){return Kl(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.en.find(function(e){return t.j(e)})||void 0!==this.fieldTransforms.find(function(e){return t.j(e.field)})},t.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},t.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Sl(this.a_)&&Nl.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),Cl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||bu(t)}return t.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Dl({a_:t,methodName:e,l_:n,path:ei.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Pl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Fl("Data must be an object, but it was:",s,r);var u,a,c=Ml(r,s);if(o.merge)u=new as(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=zl(e,l[f],n);if(!s.contains(p))throw new Mr(Vr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Wl(h,p)||h.push(p)}u=new as(h),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new kl(new As(c),u,a)}function Rl(t,e,n,r){var i=t.Rf(1,e,n);Fl("Data must be an object, but it was:",i,r);var o=[],s=new Ns;Wi(r,function(t,r){var u=Gl(e,t,n);r instanceof bf&&(r=r.o_);var a=i.If(u);if(r instanceof Nf)o.push(u);else{var c=Vl(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new as(o);return new xl(s.hn(),u,i.fieldTransforms)}function Ul(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[zl(e,r,n)],a=[i];if(o.length%2!=0)throw new Mr(Vr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(zl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ns,l=u.length-1;l>=0;--l)if(!Wl(h,u[l])){var p=u[l],d=a[l];d instanceof bf&&(d=d.o_);var v=s.If(p);if(d instanceof Nf)h.push(p);else{var y=Vl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new as(h);return new xl(f.hn(),g,s.fieldTransforms)}function Ll(t,e,n,r){return void 0===r&&(r=!1),Vl(n,t.Rf(r?4:3,e))}function Vl(t,e){if(t instanceof bf&&(t=t.o_),ql(t))return Fl("Unsupported field value:",e,t),Ml(t,e);if(t instanceof Af)return function(t,e){if(!Sl(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");var n=t.u_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.a_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Vl(o[i],e.mf(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof bf&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return wo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Yr.fromDate(t);return{timestampValue:_o(e.serializer,n)}}if(t instanceof Yr){var r=new Yr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:_o(e.serializer,r)}}if(t instanceof Pf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Rf)return{bytesValue:Io(e.serializer,t.T_)};if(t instanceof ul){var i=e.t,o=t.firestore.R_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:To(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Of(t))}(t,e)}function Ml(t,e){var n={};return Hi(t)?e.path&&e.path.length>0&&e.en.push(e.path):Wi(t,function(t,r){var i=Vl(r,e.Ef(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function ql(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Yr||t instanceof Pf||t instanceof Rf||t instanceof ul||t instanceof Af)}function Fl(t,e,n){if(!ql(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Of(n);throw e.h_("an object"===r?t+" a custom object":t+" "+r)}}function zl(t,e,n){if(e instanceof bf&&(e=e.o_),e instanceof Hf)return e.G_;if("string"==typeof e)return Gl(t,e);throw Kl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Bl=new RegExp("[~\\*/\\[\\]]");function Gl(t,e,n){if(e.search(Bl)>=0)throw Kl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Hf.bind.apply(Hf,Object(m.j)([void 0],e.split("."))))).G_}catch(r){throw Kl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Kl(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Mr(Vr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Wl(t,e){return t.some(function(t){return t.isEqual(e)})}var Hl=function(){function t(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}return t.prototype.pf=function(t){return Object(m.b)(this,void 0,void 0,function(){var e,n=this;return Object(m.e)(this,function(r){switch(r.label){case 0:if(this.vf(),this.mutations.length>0)throw new Mr(Vr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(m.e)(this,function(a){switch(a.label){case 0:return n=Lr(t),r=So(n.serializer)+"/documents",i={documents:e.map(function(t){return Ao(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Ur(!!e.found);var n=No(t,e.found.name),r=Oo(e.found.updateTime),i=new As({mapValue:{fields:e.found.fields}});return new Ss(n,r,i,{})}(t,e):"missing"in e?function(t,e){Ur(!!e.missing),Ur(!!e.readTime);var n=No(t,e.missing),r=Oo(e.readTime);return new Ds(n,r)}(t,e):Rr()}(n.serializer,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Ur(!!e),u.push(e)}),u)]}})})}(this.Nu,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Ds||t instanceof Ss?n.bf(t):Rr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},t.prototype.delete=function(t){this.write([new Ts(t,this.rn(t))]),this.Vf.add(t.toString())},t.prototype.commit=function(){return Object(m.b)(this,void 0,void 0,function(){var t,e=this;return Object(m.e)(this,function(n){switch(n.label){case 0:if(this.vf(),this.yf)throw this.yf;return t=this.Pf,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=ni.st(n);e.mutations.push(new js(r,e.rn(r)))}),[4,function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r,i;return Object(m.e)(this,function(o){switch(o.label){case 0:return n=Lr(t),r=So(n.serializer)+"/documents",i={writes:e.map(function(t){return Po(n.serializer,t)})},[4,n.Au("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return n.sent(),this.gf=!0,[2]}})})},t.prototype.bf=function(t){var e;if(t instanceof Ss)e=t.version;else{if(!(t instanceof Ds))throw Rr();e=Jr.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Mr(Vr.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?fs.updateTime(e):fs.on()},t.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(!this.Vf.has(t.toString())&&e){if(e.isEqual(Jr.min()))throw new Mr(Vr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fs.updateTime(e)}return fs.exists(!0)},t.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},t.prototype.vf=function(){},t}(),Xl=function(){function t(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new Tu(this.di,"transaction_retry")}return t.prototype.run=function(){this.Cf()},t.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return Object(m.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(m.e)(this,function(r){return t=new Hl(this.Nu),(e=this.Nf(t))&&e.then(function(e){n.di.Ri(function(){return t.commit().then(function(){n.Ti.resolve(e)}).catch(function(t){n.xf(t)})})}).catch(function(t){n.xf(t)}),[2]})})})},t.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!ri(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.xf=function(t){var e=this;this.Df>0&&this.Ff(t)?(this.Df-=1,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},t.prototype.Ff=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!yi(e)}return!1},t}(),Ql=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Nr.UNAUTHENTICATED,this.clientId=Wr.D(),this.Of=function(){},this.g=new gu,this.credentials.A(function(t){Sr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}return t.prototype.getConfiguration=function(){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},t.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},t.prototype.kf=function(){if(this.di.Ci)throw new Mr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var e=new gu;return this.di.Ni(function(){return Object(m.b)(t,void 0,void 0,function(){var t,n;return Object(m.e)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.R(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Mu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Yl(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r=this;return Object(m.e)(this,function(i){switch(i.label){case 0:return t.di.Li(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return Object(m.b)(r,void 0,void 0,function(){return Object(m.e)(this,function(t){switch(t.label){case 0:return[4,sc(e.Cu,n)];case 1:return t.sent(),[2]}})})})}),e.persistence.tc(function(){return t.terminate()}),t.Lf=e,[2]}})})}function Jl(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r;return Object(m.e)(this,function(i){switch(i.label){case 0:return t.di.Li(),[4,$l(t)];case 1:return n=i.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return function(t,e){return Object(m.b)(this,void 0,void 0,function(){var n,r;return Object(m.e)(this,function(i){switch(i.label){case 0:return(n=Lr(t)).di.Li(),Sr("RemoteStore","RemoteStore received new credentials"),r=Dc(n),n.Mu.add(3),[4,Tc(n)];case 1:return i.sent(),r&&n.Bu.set("Unknown"),[4,n.xu.s_(e)];case 2:return i.sent(),n.Mu.delete(3),[4,Oc(n)];case 3:return i.sent(),[2]}})})}(e.Oh,n)})}),t.$f=e,[2]}})})}function $l(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return t.Lf?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,Yl(t,new pf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.Lf]}})})}function Zl(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return t.$f?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,Jl(t,new yf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}})})}function tp(t){return $l(t).then(function(t){return t.persistence})}function ep(t){return $l(t).then(function(t){return t.Cu})}function np(t){return Zl(t).then(function(t){return t.Oh})}function rp(t){return Zl(t).then(function(t){return t.ga})}function ip(t){return Object(m.b)(this,void 0,void 0,function(){var e,n;return Object(m.e)(this,function(r){switch(r.label){case 0:return[4,Zl(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ju=_h.bind(null,e.ga),n.Zu=Eh.bind(null,e.ga),n)]}})})}function op(t,e,n,r,i){var o=new gf({next:function(o){e.Ri(function(){return $c(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Mr(Vr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Mr(Vr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new nh(Us(n.path),o,{includeMetadataChanges:!0,oa:!0});return Jc(t,s)}function sp(t,e,n,r,i){var o=new gf({next:function(n){e.Ri(function(){return $c(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Mr(Vr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new nh(n,o,{includeMetadataChanges:!0,oa:!0});return Jc(t,s)}var up=function(){function t(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=Al(t)}return t.prototype.set=function(t,e,n){this.Kf();var r=ap(t,this.U_),i=Np(r.j_,e,n),o=Pl(this.Qf,"WriteBatch.set",r.K_,i,null!==r.j_,n);return this.qf=this.qf.concat(o.ef(r.K_,fs.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();var o,s=ap(t,this.U_);return e instanceof bf&&(e=e.o_),o="string"==typeof e||e instanceof Hf?Ul(this.Qf,"WriteBatch.update",s.K_,e,n,r):Rl(this.Qf,"WriteBatch.update",s.K_,e),this.qf=this.qf.concat(o.ef(s.K_,fs.exists(!0))),this},t.prototype.delete=function(t){this.Kf();var e=ap(t,this.U_);return this.qf=this.qf.concat(new Ts(e.K_,fs.on())),this},t.prototype.commit=function(){return this.Kf(),this.Uf=!0,this.qf.length>0?this.Bf(this.qf):Promise.resolve()},t.prototype.Kf=function(){if(this.Uf)throw new Mr(Vr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function ap(t,e){if(t instanceof bf&&(t=t.o_),t.firestore!==e)throw new Mr(Vr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var cp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).U_=e,r}return Object(m.d)(e,t),e.prototype.get=function(e){var n=this,r=ap(e,this.U_),i=new nl(this.U_);return t.prototype.get.call(this,e).then(function(t){return new Jf(n.U_,i,r.K_,t.W_,new wp(!1,!1),r.j_)})},e}(function(){function t(t,e){this.U_=t,this.Wf=e,this.Qf=Al(t)}return t.prototype.get=function(t){var e=this,n=ap(t,this.U_),r=new Ol(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return Rr();var i=t[0];if(i instanceof Ds)return new Gf(e.U_,r,n.K_,null,n.j_);if(i instanceof Ss)return new Gf(e.U_,r,i.key,i,n.j_);throw Rr()})},t.prototype.set=function(t,e,n){var r=ap(t,this.U_),i=Np(r.j_,e,n),o=Pl(this.Qf,"Transaction.set",r.K_,i,null!==r.j_,n);return this.Wf.set(r.K_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=ap(t,this.U_);return e instanceof bf&&(e=e.o_),o="string"==typeof e||e instanceof Hf?Ul(this.Qf,"Transaction.update",s.K_,e,n,r):Rl(this.Qf,"Transaction.update",s.K_,e),this.Wf.update(s.K_,o),this},t.prototype.delete=function(t){var e=ap(t,this.U_);return this.Wf.delete(e.K_),this},t}()),hp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Yf(t);var n=lp(t),r=t.S_(),i=new yf;return Qf(n,i,new df(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Yf(t);var e=lp(t),n=t.S_(),r=new yf;return Qf(e,r,new vf(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.y_&&!t.V_)throw new Mr(Vr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new gu;return t.z_.Ni(function(){return Object(m.b)(e,void 0,void 0,function(){var e;return Object(m.e)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(m.b)(this,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return ju.Gs()?[4,ju.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(rc(t.R_,t.I_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.o_)},t}(),fp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).jf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Ar||(i.Gf=e),i}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Cr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(m.b)(e,void 0,void 0,function(){var e,n;return Object(m.e)(this,function(r){switch(r.label){case 0:return[4,tp(t)];case 1:return e=r.sent(),[4,np(t)];case 2:return n=r.sent(),[2,(e.ec(!0),function(t){var e=Lr(t);return e.Mu.delete(0),Oc(e)}(n))]}})})})}(lp(this.o_))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(m.b)(e,void 0,void 0,function(){var e,n;return Object(m.e)(this,function(r){switch(r.label){case 0:return[4,tp(t)];case 1:return e=r.sent(),[4,np(t)];case 2:return n=r.sent(),[2,(e.ec(!1),function(t){return Object(m.b)(this,void 0,void 0,function(){var e;return Object(m.e)(this,function(n){switch(n.label){case 0:return(e=Lr(t)).Mu.add(0),[4,Tc(e)];case 1:return n.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(lp(this.o_))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&_f("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new gu;return t.di.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){var e;return Object(m.e)(this,function(r){switch(r.label){case 0:return e=xh,[4,rp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(lp(this.o_))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=lp(t),i=mu(e)?e:{next:e},o=new gf(i);return t.z_.Ri(function(){return Object(m.b)(n,void 0,void 0,function(){var t;return Object(m.e)(this,function(e){switch(e.label){case 0:return t=function(t,e){Lr(t).Hu.add(e),e.next()},[4,ip(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})}),function(){o.r_(),t.z_.Ri(function(){return Object(m.b)(n,void 0,void 0,function(){var t;return Object(m.e)(this,function(e){switch(e.label){case 0:return t=function(t,e){Lr(t).Hu.delete(e)},[4,ip(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})})}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Gf)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new jp(this,Il(this.o_,t))}catch(t){throw gp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new yp(this,El(this.o_,t))}catch(t){throw gp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Ep(this,function(t,e){if(mf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new al(t,null,function(t){return new Ps(Zr.X(),t)}(e))}(this.o_,t))}catch(t){throw gp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new gu;return t.di.Ri(function(){return Object(m.b)(n,void 0,void 0,function(){var n;return Object(m.e)(this,function(i){switch(i.label){case 0:return[4,function(t){return Zl(t).then(function(t){return t.Nu})}(t)];case 1:return n=i.sent(),new Xl(t.di,n,e,r).run(),[2]}})})}),r.promise}(lp(t),function(n){return e(new cp(t,n))})}(this.o_,function(n){return t(new dp(e,n))})},e.prototype.batch=function(){var t=this;return lp(this.o_),new vp(new up(this.o_,function(e){return ol(t.o_,e)}))},e}(bf);function lp(t){return t.H_||pp(t),t.H_.kf(),t.H_}function pp(t){var e=t.S_(),n=function(t,e,n){return new jr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.R_,t.I_,e);t.H_=new Ql(t.P_,t.z_,n)}var dp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(m.d)(e,t),e.prototype.get=function(t){var e=this,n=Ap(t);return this.o_.get(n).then(function(t){return new _p(e.U_,t)})},e.prototype.set=function(t,e,n){var r=Ap(t);return n?(wf("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Ap(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(m.j)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Ap(t);return this.o_.delete(e),this},e}(bf),vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.set=function(t,e,n){var r=Ap(t);return n?(wf("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Ap(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(m.j)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Ap(t);return this.o_.delete(e),this},e.prototype.commit=function(){return this.o_.commit()},e}(bf),yp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Q_=new Bf(e),r}return Object(m.d)(e,t),e.zf=function(t,n,r){if(t.length%2!=0)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new e(n,new ul(n.o_,r,new ni(t)))},e.q_=function(t,n,r){return new e(n,new ul(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new jp(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new jp(this.firestore,Il(this.o_,t))}catch(t){throw gp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof bf&&(t=t.o_),t instanceof ul&&Tl(this.o_,t)},e.prototype.set=function(t,e){e=wf("DocumentReference.set",e);try{return function(t,e,n){var r=Tf(t.firestore,Xf),i=Np(t.j_,e,n);return ol(r,Pl(Al(r),"setDoc",t.K_,i,null!==t.j_,n).ef(t.K_,fs.on()))}(this.o_,t,e)}catch(t){throw gp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?rl(this.o_,t):rl.apply(void 0,Object(m.j)([this.o_,t,e],n))}catch(t){throw gp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return ol(Tf((t=this.o_).firestore,Xf),[new Ts(t.K_,fs.on())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=bp(e),i=mp(e,function(e){return new _p(t.firestore,new Jf(t.firestore.o_,t.Q_,e.K_,e.W_,e.metadata,t.o_.j_))});return il(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=Tf(t.firestore,Xf),r=lp(n),i=new nl(n),o=new gu;return n.z_.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,ep(r)];case 1:return[4,function(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o;return Object(m.e)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=Lr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)})}(t,e)];case 1:return(r=s.sent())instanceof Ss?n.resolve(r):r instanceof Ds?n.resolve(null):n.reject(new Mr(Vr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=Mu(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})}(e.sent(),t.K_,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Jf(n,i,t.K_,e,new wp(e instanceof Ss&&e.an,!0),t.j_)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=Tf(t.firestore,Xf),r=lp(n),i=new gu;return n.z_.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,ip(r)];case 1:return[4,op(e.sent(),n.z_,t.K_,{source:"server"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return sl(n,t,e)})}(this.o_):function(t){var e=this,n=Tf(t.firestore,Xf),r=lp(n),i=new gu;return n.z_.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,ip(r)];case 1:return[4,op(e.sent(),n.z_,t.K_,{source:"default"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return sl(n,t,e)})}(this.o_)).then(function(t){return new _p(e.firestore,new Jf(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(bf);function gp(t,e,n){return t.message=t.message.replace(e,n),t}function bp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!mu(r))return r}return{}}function mp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=mu(t[0])?t[0]:mu(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var wp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),_p=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new yp(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return el(this.o_,t.o_)},e}(bf),Ip=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(_p),Ep=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r}return Object(m.d)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,hl(this.o_,function(t,e,n){var r=e,i=Wf("where",t);return new fl(i,r,n)}(t,n,r)))}catch(t){throw gp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,hl(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=Wf("orderBy",t);return new ll(r,n)}(t,n)))}catch(t){throw gp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,hl(this.o_,function(t){return jf("limit",t),new pl("limit",t,"F")}(t)))}catch(t){throw gp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,hl(this.o_,function(t){return jf("limitToLast",t),new pl("limitToLast",t,"L")}(t)))}catch(t){throw gp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dl("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw gp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dl("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw gp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vl("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw gp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vl("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw gp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return jl(this.o_,t.o_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=Tf(t.firestore,Xf),r=lp(n),i=new nl(n),o=new gu;return n.z_.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,ep(r)];case 1:return[4,function(t,e,n){return Object(m.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(m.e)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,pc(t,e,!0)];case 1:return r=c.sent(),i=new gh(e,r.Bc),o=i.gh(r.documents),s=i.Zn(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=c.sent(),a=Mu(u,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})}(e.sent(),t.tf,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Zf(n,i,t,e)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=Tf(t.firestore,Xf),r=lp(n),i=new nl(n),o=new gu;return n.z_.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,ip(r)];case 1:return[4,sp(e.sent(),n.z_,t.tf,{source:"server"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Zf(n,i,t,e)})}(this.o_):function(t){var e=this,n=Tf(t.firestore,Xf),r=lp(n),i=new nl(n);wl(t.tf);var o=new gu;return n.z_.Ri(function(){return Object(m.b)(e,void 0,void 0,function(){return Object(m.e)(this,function(e){switch(e.label){case 0:return[4,ip(r)];case 1:return[4,sp(e.sent(),n.z_,t.tf,{source:"default"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Zf(n,i,t,e)})}(this.o_)).then(function(t){return new Tp(e.firestore,t)})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=bp(e),i=mp(e,function(e){return new Tp(t.firestore,e)});return il(this.o_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(bf),Op=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Ip(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),e}(bf),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Ep(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map(function(e){return new Ip(t.U_,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new Op(e.U_,t)})},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach(function(r){t.call(e,new Ip(n.U_,r))})},e.prototype.isEqual=function(t){return el(this.o_,t.o_)},e}(bf),jp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return Object(m.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new yp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new yp(this.firestore,void 0===t?El(this.o_):El(this.o_,t))}catch(t){throw gp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Tf(t.firestore,Xf),r=El(t),i=Np(t.j_,e);return ol(n,Pl(Al(t.firestore),"addDoc",r.K_,i,null!==t.j_,{}).ef(r.K_,fs.exists(!1))).then(function(){return r})}(this.o_,t).then(function(t){return new yp(e.firestore,t)})},e.prototype.isEqual=function(t){return Tl(this.o_,t.o_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Ep);function Ap(t){return t instanceof bf&&(t=t.o_),Tf(t,ul)}function Np(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var kp,xp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Hf.bind.apply(Hf,Object(m.j)([void 0],e))))||this}return Object(m.d)(e,t),e.documentId=function(){return new e(ei.et().J())},e.prototype.isEqual=function(t){return t instanceof bf&&(t=t.o_),t instanceof Hf&&this.o_.G_.isEqual(t.G_)},e}(bf),Sp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.d)(e,t),e.serverTimestamp=function(){var t=new xf("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Nf("deleteField");return t.c_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sf("arrayUnion",t)}).apply(void 0,t);return r.c_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Df("arrayRemove",t)}).apply(void 0,t);return r.c_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Cf("increment",t)}(t);return n.c_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(bf),Dp={Firestore:fp,GeoPoint:Pf,Timestamp:Yr,Blob:Ff,Transaction:dp,WriteBatch:vp,DocumentReference:yp,DocumentSnapshot:_p,Query:Ep,QueryDocumentSnapshot:Ip,QuerySnapshot:Tp,CollectionReference:jp,FieldPath:xp,FieldValue:Sp,setLogLevel:function(t){kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Tr.a("firestore",function(t){return function(t,e){return new fp(t,new Xf(t,e),new hp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Dp)))})(kp=w.a),kp.registerVersion("@firebase/firestore","2.0.4");var Cp=s("Jgta"),Pp=s("UbJi");function Rp(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.b;return new h.a(function(n){var r;return null!=e?e.schedule(function(){r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),function(){null!=r&&r()}})}(t,e)}function Up(t,e){return Rp(t,e).pipe(Object(p.a)(function(t){return{payload:t,type:"query"}}))}function Lp(t,e){return Up(t,e).pipe(Object(p.a)(function(t){return t.payload.docChanges().map(function(t){return{type:t.type,payload:t}})}))}function Vp(t,e,n){return Up(t,n).pipe(Object(p.a)(function(t){return t.payload.docChanges()}),Object(d.a)(function(t,n){return function(t,e,n){return e.forEach(function(e){n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e)},[]),Object(p.a)(function(t){return t.map(function(t){return{type:t.type,payload:t}})}))}function Mp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}var qp=function(){function t(e,n,r){o(this,t),this.ref=e,this.query=n,this.afs=r}return u(t,[{key:"stateChanges",value:function(t){return t&&0!==t.length?Lp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(function(e){return e.filter(function(e){return t.indexOf(e.type)>-1})}),Object(v.a)(function(t){return t.length>0}),this.afs.keepUnstableUntilFirst):Lp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Object(d.a)(function(t,e){return[].concat(n(t),n(e))},[]))}},{key:"snapshotChanges",value:function(t){var e=Mp(t);return Vp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Up(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(function(n){return n.payload.docs.map(function(n){return t.idField?Object.assign(Object.assign({},n.data()),e({},t.idField,n.id)):n.data()})}),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(t){return Object(f.a)(this.query.get(t)).pipe(Object(y.b)(this.afs.schedulers.insideAngular))}},{key:"add",value:function(t){return this.ref.add(t)}},{key:"doc",value:function(t){return new Fp(this.ref.doc(t),this.afs)}}]),t}(),Fp=function(){function t(e,n){o(this,t),this.ref=e,this.afs=n}return u(t,[{key:"set",value:function(t,e){return this.ref.set(t,e)}},{key:"update",value:function(t){return this.ref.update(t)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(t,e){var n=Hp(this.ref.collection(t),e),r=n.ref,i=n.query;return new qp(r,i,this.afs)}},{key:"snapshotChanges",value:function(){return Rp(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(function(t){return{payload:t,type:"value"}})).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.snapshotChanges().pipe(Object(p.a)(function(n){var r=n.payload;return t.idField?Object.assign(Object.assign({},r.data()),e({},t.idField,r.id)):r.data()}))}},{key:"get",value:function(t){return Object(f.a)(this.ref.get(t)).pipe(Object(y.b)(this.afs.schedulers.insideAngular))}}]),t}(),zp=function(){function t(e,n){o(this,t),this.query=e,this.afs=n}return u(t,[{key:"stateChanges",value:function(t){return t&&0!==t.length?Lp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(function(e){return e.filter(function(e){return t.indexOf(e.type)>-1})}),Object(v.a)(function(t){return t.length>0}),this.afs.keepUnstableUntilFirst):Lp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Object(d.a)(function(t,e){return[].concat(n(t),n(e))},[]))}},{key:"snapshotChanges",value:function(t){var e=Mp(t);return Vp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Up(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(function(n){return n.payload.docs.map(function(n){return t.idField?Object.assign(e({},t.idField,n.id),n.data()):n.data()})}),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(t){return Object(f.a)(this.query.get(t)).pipe(Object(y.b)(this.afs.schedulers.insideAngular))}}]),t}(),Bp=new a.q("angularfire2.enableFirestorePersistence"),Gp=new a.q("angularfire2.firestore.persistenceSettings"),Kp=new a.q("angularfire2.firestore.settings"),Wp=new a.q("angularfire2.firestore.use-emulator");function Hp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return{query:e(t),ref:t}}var Xp,Qp=((Xp=function(){function e(r,i,s,u,a,c,h,p,d){o(this,e),this.schedulers=new g.e(c),this.keepUnstableUntilFirst=Object(g.i)(this.schedulers);var v=Object(g.h)(r,c,i);!Cp.a.auth&&d&&Object(g.k)();var y=p,m=t(Object(g.g)(v.name+".firestore","AngularFirestore",v,function(){var t=c.runOutsideAngular(function(){return v.firestore()});return u&&t.settings(u),y&&t.useEmulator.apply(t,n(y)),s&&!Object(b.s)(a)?[t,c.runOutsideAngular(function(){try{return Object(f.a)(t.enablePersistence(h||void 0).then(function(){return!0},function(){return!1}))}catch(e){return"undefined"!=typeof console&&console.warn(e),Object(l.a)(!1)}})]:[t,Object(l.a)(!1)]},[u,y,s]),2);this.firestore=m[0],this.persistenceEnabled$=m[1]}return u(e,[{key:"collection",value:function(t,e){var n=Hp("string"==typeof t?this.firestore.collection(t):t,e),r=n.ref,i=n.query,o=this.schedulers.ngZone.run(function(){return r});return new qp(o,i,this)}},{key:"collectionGroup",value:function(t,e){var n=e||function(t){return t},r=this.firestore.collectionGroup(t);return new zp(n(r),this)}},{key:"doc",value:function(t){var e;e="string"==typeof t?this.firestore.doc(t):t;var n=this.schedulers.ngZone.run(function(){return e});return new Fp(n,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),e}()).\u0275fac=function(t){return new(t||Xp)(a.Ub(g.c),a.Ub(g.b,8),a.Ub(Bp,8),a.Ub(Kp,8),a.Ub(a.B),a.Ub(a.z),a.Ub(Gp,8),a.Ub(Wp,8),a.Ub(Pp.c,8))},Xp.\u0275prov=Object(a.Hb)({factory:function(){return new Xp(Object(a.Ub)(g.c),Object(a.Ub)(g.b,8),Object(a.Ub)(Bp,8),Object(a.Ub)(Kp,8),Object(a.Ub)(a.B),Object(a.Ub)(a.z),Object(a.Ub)(Gp,8),Object(a.Ub)(Wp,8),Object(a.Ub)(Pp.c,8))},token:Xp,providedIn:"any"}),Xp)},jTqx:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t){return t.aboutMe="about-me",t.assortments="assortments",t.sliderImg="slider-img",t}({})}}])}();